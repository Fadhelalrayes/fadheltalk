<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ â€” ØªÙ‚Ø¯ÙŠØ± Ø£ÙˆÙ„ÙŠ ÙˆÙ†ØµØ§Ø¦Ø­ Ø¹Ø§Ø¬Ù„Ø©</title>
<meta name="description" content="Ø£Ø¯Ø§Ø© Ø¹Ø±Ø¨ÙŠØ© Ø³Ø±ÙŠØ¹Ø© Ù„ØªÙ‚ÙŠÙŠÙ… Ø£ÙˆÙ„ÙŠ Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ Ù…Ø¹ Ù†ØµØ§Ø¦Ø­ Ø·ÙˆØ§Ø±Ø¦ ÙˆØ±ÙˆØ§Ø¨Ø· Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù…Ø­Ù„ÙŠØ© ÙˆØ¹Ø§Ù„Ù…ÙŠØ©. Ù„ÙŠØ³Øª Ø¨Ø¯ÙŠÙ„Ø§Ù‹ Ø¹Ù† Ø§Ù„Ø·Ø¨ÙŠØ¨.">
<link rel="canonical" href="https://example.com/heart-checker-ar"/>
<meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1">
<meta property="og:locale" content="ar_AR">
<meta property="og:type" content="website">
<meta property="og:title" content="ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ â€” ØªÙ‚Ø¯ÙŠØ± Ø£ÙˆÙ„ÙŠ ÙˆÙ†ØµØ§Ø¦Ø­ Ø¹Ø§Ø¬Ù„Ø©">
<meta property="og:description" content="ØªÙ‚ÙŠÙŠÙ… Ø£ÙˆÙ„ÙŠ Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ + Ø·ÙˆØ§Ø±Ø¦ + Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù…ÙˆØ«ÙˆÙ‚Ø©.">
<meta property="og:url" content="https://example.com/heart-checker-ar">
<meta property="og:site_name" content="Heart Checker AR">
<meta property="og:image" content="https://example.com/assets/heart-checker-cover.png">
<meta property="og:image:alt" content="ÙˆØ§Ø¬Ù‡Ø© ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ">
<meta name="twitter:card" content="summary_large_image">

<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#f6f7fa; --ink:#0f172a; --muted:#64748b;
    --card:#ffffff; --line:#e5e7eb;
    --gold:#b58900; --gold-soft:#f5d574;
    --ok:#10b981; --ok-bg:#ecfdf5; --ok-br:#a7f3d0;
    --warn:#f59e0b; --warn-bg:#fffbeb; --warn-br:#fde68a;
    --danger:#ef4444; --danger-bg:#fef2f2; --danger-br:#fecaca;
    --shadow:0 8px 24px rgba(0,0,0,.06);
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:"Cairo",sans-serif; background:var(--bg); color:var(--ink)}
  header{text-align:center; padding:24px 12px}
  .brand{font-family:"Amiri",serif; font-size:clamp(26px,4.5vw,42px); color:var(--gold)}
  .tag{margin-top:6px; font-size:14px; color:var(--muted); line-height:1.8}
  .shell{max-width:1100px; margin:0 auto; padding:0 16px}
  .hero{background:var(--card); border:1px solid var(--line); border-radius:20px; padding:20px; box-shadow:var(--shadow)}
  .row{display:grid; gap:16px}
  @media(min-width:980px){ .row{grid-template-columns:1.2fr .8fr} }

  .field{display:flex; flex-direction:column; gap:6px; margin-bottom:12px}
  .hint{font-size:12px; color:var(--muted)}
  .center{text-align:center}
  .seg{display:flex; gap:6px; justify-content:center; flex-wrap:wrap}
  .seg button{
    flex:1; padding:10px 14px; border-radius:10px; border:1px solid var(--line);
    background:#f9fafb; cursor:pointer; max-width:220px; font-weight:700; user-select:none; transition:.2s
  }
  .seg button.on{background:var(--gold); color:#111; border-color:var(--gold); outline:none}

  .select{ position:relative; display:inline-block; width:100% }
  .select select{
    width:100%; appearance:none; background:#fff; border:1px solid var(--gold); border-radius:10px;
    padding:12px 42px 12px 12px; font-size:1rem; cursor:pointer; color:#111; text-align:right;
  }
  .select::after{
    content:""; position:absolute; top:50%; transform:translateY(-50%); right:12px; width:18px; height:18px;
    background:linear-gradient(135deg,var(--gold),var(--gold-soft));
    -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    pointer-events:none; opacity:.95;
  }

  .btn{padding:12px 20px; border-radius:10px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--gold),var(--gold-soft)); color:#111; font-weight:700; display:block; margin:0 auto}

  .resultbox{display:none; border-radius:14px; padding:14px; border:1px solid; font-weight:700; text-align:center}
  .rb-ok{ background:var(--ok-bg); border-color:var(--ok-br); color:#064e3b }
  .rb-warn{ background:var(--warn-bg); border-color:var(--warn-br); color:#7c2d12 }
  .rb-danger{ background:var(--danger-bg); border-color:var(--danger-br); color:#7f1d1d }

  .deck{display:grid; gap:12px; grid-template-columns:1fr; margin-top:16px}
  @media(min-width:860px){ .deck{grid-template-columns:repeat(2,1fr)} }
  .card{background:#fff; border:1px solid var(--line); border-radius:12px; padding:14px; box-shadow:0 2px 10px rgba(0,0,0,.04)}
  .card h3{margin:0 0 6px; font-family:"Amiri",serif; color:var(--gold)}
  .card p, .card ul{margin:0; font-size:14px; color:#374151; line-height:1.9}
  .card ul{margin-top:8px; padding-inline-start:20px}

  .iconbtn{width:34px; height:34px; border-radius:8px; display:flex; align-items:center; justify-content:center; border:1px solid var(--line); background:#fff; cursor:pointer}

  .pdfwrap{margin-top:12px; text-align:center; display:none}
  .pdfbtn{padding:10px 16px; border-radius:10px; border:1px solid var(--gold); background:#fff; cursor:pointer; font-weight:700}

  /* Ù†Ø§ÙØ°Ø© Ø±Ø³Ø§Ø¦Ù„ Ù…Ø­Ø³Ù‘Ù†Ø© */
  .msg-backdrop{position:fixed; inset:0; background:rgba(17,24,39,.35); display:none; align-items:center; justify-content:center; z-index:99999}
  .msg-backdrop.show{ display:flex }
  .msg-box{width:min(92vw,540px); background:#fff; border:1px solid var(--gold); border-radius:16px; box-shadow:0 20px 50px rgba(0,0,0,.18); padding:18px; text-align:center}
  .msg-title{font-family:"Amiri",serif; font-size:20px; color:#b58900; margin:6px 0 2px}
  .msg-text{ color:#374151; line-height:1.8; margin:8px 0 14px }
  .msg-actions{ display:flex; gap:8px; justify-content:center; flex-wrap:wrap }
  .msg-btn{padding:10px 18px; border-radius:10px; border:1px solid var(--gold); background:linear-gradient(90deg,var(--gold),var(--gold-soft)); color:#111; font-weight:700; cursor:pointer}
  .msg-ghost{padding:10px 18px; border-radius:10px; border:1px solid var(--line); background:#fff; color:#111; cursor:pointer}
  .msg-box.error{ border-color:#fecaca }
  .msg-box.error .msg-title{ color:#ef4444 }

  /* ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø·ÙˆØ§Ø±Ø¦ Ø£Ù†ÙŠÙ‚Ø© */
  .emg{border-radius:14px; padding:14px; box-shadow:var(--shadow); border:1px solid var(--line)}
  .emg-a{background:#fff5f5; border-left:6px solid #ef4444}
  .emg-b{background:#fffbea; border-left:6px solid #f59e0b}

  /* Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ù…Ø·ÙˆØ± â€” Ø²Ø± Ø®ÙÙŠ */
  #devLinkBtn{background:none; border:none; padding:0; font:inherit; color:inherit; cursor:pointer}
</style>

<!-- Structured Data Ù…Ø®ØªØµØ± -->
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebApplication","name":"ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨","inLanguage":"ar","applicationCategory":"HealthApplication","offers":{"@type":"Offer","price":"0"}}
</script>
</head>
<body>
<header>
  <div class="brand">ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</div>
  <div class="tag">
    ØªÙ‚Ø¯ÙŠØ± Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ÙŠØ© + Ù†ØµØ§Ø¦Ø­ Ø·ÙˆØ§Ø±Ø¦ + Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù…ÙˆØ«ÙˆÙ‚Ø©. Ù„ÙŠØ³Øª ØªØ´Ø®ÙŠØµÙ‹Ø§ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§.
  </div>
</header>

<main class="shell">
  <section class="hero">
    <div class="row">
      <div>
        <!-- Ø§Ù„Ø¯ÙˆÙ„Ø© -->
        <div class="field">
          <label><strong>Ø§Ø®ØªØ± Ø¯ÙˆÙ„ØªÙƒ</strong></label>
          <div class="select">
            <select id="countrySelect" aria-label="Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©">
              <!-- Ø§Ù„Ø®Ù„ÙŠØ¬ -->
              <option value="BHR" selected>Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
              <option value="KSA">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
              <option value="ARE">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
              <option value="QAT">Ù‚Ø·Ø±</option>
              <option value="KWT">Ø§Ù„ÙƒÙˆÙŠØª</option>
              <option value="OMN">Ø¹ÙÙ…Ø§Ù†</option>
              <!-- Ø§Ù„Ù…Ø´Ø±Ù‚ -->
              <option value="JOR">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
              <option value="LBN">Ù„Ø¨Ù†Ø§Ù†</option>
              <option value="PSE">ÙÙ„Ø³Ø·ÙŠÙ†</option>
              <option value="SYR">Ø³ÙˆØ±ÙŠØ§</option>
              <option value="IRQ">Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
              <!-- ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù†ÙŠÙ„ ÙˆØ§Ù„Ù‚Ø±Ù† -->
              <option value="EGY">Ù…ØµØ±</option>
              <option value="SDN">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
              <option value="SOM">Ø§Ù„ØµÙˆÙ…Ø§Ù„</option>
              <option value="DJI">Ø¬ÙŠØ¨ÙˆØªÙŠ</option>
              <option value="COM">Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±</option>
              <option value="MRT">Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§</option>
              <!-- Ø§Ù„Ù…ØºØ±Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ -->
              <option value="MAR">Ø§Ù„Ù…ØºØ±Ø¨</option>
              <option value="DZA">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
              <option value="TUN">ØªÙˆÙ†Ø³</option>
              <option value="LBA">Ù„ÙŠØ¨ÙŠØ§</option>
              <!-- Ø¥ÙŠØ±Ø§Ù† -->
              <option value="IRN">Ø¥ÙŠØ±Ø§Ù†</option>
              <!-- Ø§Ù„ÙŠÙ…Ù† -->
              <option value="YEM">Ø§Ù„ÙŠÙ…Ù†</option>
            </select>
          </div>
          <div class="hint">Ù„Ø¹Ø±Ø¶ Ù…Ø³ØªØ´ÙÙ‰ Ù‚Ù„Ø¨ Ù…Ø­Ù„ÙŠ Ù…ÙˆØµÙ‰ Ø¨Ù‡ (Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø± + Ù…ÙˆÙ‚Ø¹ Ø±Ø³Ù…ÙŠ).</div>
        </div>

        <!-- Ø§Ù„Ù†ÙˆØ¹ -->
        <div class="field center">
          <label><strong>Ø§Ù„Ù†ÙˆØ¹</strong></label>
          <div class="seg" id="sexSeg">
            <button type="button" class="on" data-sex="male">Ø±Ø¬Ù„</button>
            <button type="button" data-sex="female">Ø§Ù…Ø±Ø£Ø©</button>
          </div>
        </div>

        <!-- Ø§Ù„Ø¹Ù…Ø± -->
        <div class="field center">
          <label><strong>Ø§Ù„Ø¹Ù…Ø±</strong></label>
          <input id="age" type="number" inputmode="numeric" min="1" max="120" placeholder="Ù…Ø«Ø§Ù„: 45" style="width:180px; padding:12px; border:1px solid var(--line); border-radius:10px; text-align:center; margin:0 auto">
          <div class="hint">Ø¥Ù† Ù„Ù… ØªØ¯Ø®Ù„ Ø§Ù„Ø¹Ù…Ø± Ù„Ù† ØªÙØ­ØªØ³Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© â€” Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø±Ù‹Ø§ Ø¨ÙŠÙ† 1 Ùˆ 120.</div>
        </div>

        <!-- Ø¹ÙˆØ§Ù…Ù„ Ø®Ø·ÙˆØ±Ø© ÙˆÙˆØ±Ø§Ø«Ø© -->
        <div class="field center">
          <label><strong>Ø¹ÙˆØ§Ù…Ù„ Ù…Ø¤Ø«Ù‘Ø±Ø©</strong></label>
          <div class="seg" id="smokeSeg">
            <button type="button" class="on" data-smoke="no">ØºÙŠØ± Ù…Ø¯Ø®Ù‘Ù†</button>
            <button type="button" data-smoke="yes">Ù…Ø¯Ø®Ù‘Ù†</button>
          </div>
          <div style="margin-top:8px" class="seg" id="familySeg">
            <button type="button" class="on" data-fh="no">Ù„Ø§ ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚Ù„Ø¨ÙŠ Ù…Ø¨ÙƒØ±</button>
            <button type="button" data-fh="yes">ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚Ù„Ø¨ÙŠ Ù…Ø¨ÙƒØ±</button>
          </div>
          <div style="margin-top:8px" class="seg" id="genSeg">
            <button type="button" class="on" data-gen="no">Ù„Ø§ ÙˆØ±Ø§Ø«Ø© Ù…Ø¹Ø±ÙˆÙØ©</button>
            <button type="button" data-gen="yes">ÙˆØ±Ø§Ø«Ø© Ø¯Ù‚ÙŠÙ‚Ø© (ÙØ±Ø· ÙƒÙˆÙ„ÙŠØ³ØªØ±ÙˆÙ„ Ø§Ù„Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„ÙŠ/Ø§Ø¹ØªÙ„Ø§Ù„ Ø¹Ø¶Ù„Ø© Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ø¶ÙØ®Ø§Ù…ÙŠ/Ù…ØªÙ„Ø§Ø²Ù…Ø© ÙØªØ±Ø© QT Ø§Ù„Ø·ÙˆÙŠÙ„Ø©/Ù…ØªÙ„Ø§Ø²Ù…Ø© Ø¨Ø±ÙˆØºØ§Ø¯Ø§)</button>
          </div>
        </div>

        <!-- Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ÙŠØ© -->
        <div id="symptoms" class="card" aria-live="polite">
          <h3>Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ÙŠØ© (Ø§Ø®ØªØ± Ù†Ø¹Ù…/Ù„Ø§)</h3>
          <div class="hint">Ø£ÙŠ Ø£Ù„Ù… ØµØ¯Ø±ÙŠ Ø­Ø§Ø¯ Ø£Ùˆ Ø¶ÙŠÙ‚ Ù†ÙØ³ Ø´Ø¯ÙŠØ¯ = Ø·ÙˆØ§Ø±Ø¦.</div>

          <div class="field"><div><strong>Ø£Ù„Ù…/Ø¶ØºØ· ØµØ¯Ø±ÙŠ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø¯ Ø£Ùˆ Ø§Ù„Ø±Ø§Ø­Ø©</strong></div>
            <div class="seg" data-q="chestpain"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø¶ÙŠÙ‚ Ù†ÙØ³ Ø¨Ø§Ù„Ø¬Ù‡Ø¯ Ø£Ùˆ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ù‚Ø§Ø¡</strong></div>
            <div class="seg" data-q="sob"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø®ÙÙ‚Ø§Ù† Ø³Ø±ÙŠØ¹/ØºÙŠØ± Ù…Ù†ØªØ¸Ù… Ø£Ùˆ Ø¥ØºÙ…Ø§Ø¡</strong></div>
            <div class="seg" data-q="palp"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>ØªÙˆØ±Ù‘Ù… Ø§Ù„Ø³Ø§Ù‚ÙŠÙ†/Ø§Ù„ÙƒØ§Ø­Ù„ÙŠÙ† Ø£Ùˆ Ø²ÙŠØ§Ø¯Ø© Ù…ÙØ§Ø¬Ø¦Ø© Ø¨Ø§Ù„ÙˆØ²Ù†</strong></div>
            <div class="seg" data-q="edema"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø£Ù„Ù… ØµØ¯Ø±ÙŠ Ù…Ø¹ ØªØ¹Ø±Ù‘Ù‚ Ø´Ø¯ÙŠØ¯/ØºØ«ÙŠØ§Ù†</strong></div>
            <div class="seg" data-q="acs"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø£Ù„Ù… ÙŠÙ†ØªØ´Ø± Ù„Ù„Ø°Ø±Ø§Ø¹/Ø§Ù„Ø¸Ù‡Ø±/Ø§Ù„ÙÙƒ Ø£Ùˆ Ø¶ÙŠÙ‚ Ù†ÙØ³ Ù„ÙŠÙ„ÙŠ Ù…ÙØ§Ø¬Ø¦</strong></div>
            <div class="seg" data-q="rad"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø¶ØºØ·/Ø³ÙƒØ±/ÙƒÙˆÙ„Ø³ØªØ±ÙˆÙ„ ØºÙŠØ± Ù…Ø¶Ø¨ÙˆØ·</strong></div>
            <div class="seg" data-q="rf"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
          <div class="field"><div><strong>Ø£Ù„Ù… Ø£Ùˆ Ø®ÙÙ‚Ø§Ù† Ø¬Ø¯ÙŠØ¯ Ø¨Ø¹Ø¯ ÙƒÙˆÙÙŠØ¯/Ø¥Ø¬Ù‡Ø§Ø¯</strong></div>
            <div class="seg" data-q="postcovid"><button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button></div>
          </div>
        </div>

        <button class="btn" id="calc">Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        <div class="pdfwrap" id="pdfwrap">
          <button class="pdfbtn" id="pdfBtn">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ PDF</button>
        </div>
      </div>

      <div>
        <!-- Ù†ØªÙŠØ¬Ø© -->
        <div id="resultBox" class="resultbox rb-ok" role="status" aria-live="polite" aria-atomic="true">
          Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©: <span id="riskText">Ù…Ù†Ø®ÙØ¶Ø©</span> â€” <span id="actionText">Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„ØªØ²Ù… Ø¨Ù†Ù…Ø· Ø­ÙŠØ§Ø© Ù‚Ù„Ø¨ÙŠ ØµØ­ÙŠ.</span>
        </div>

        <!-- âœ… Ø£Ø¶ÙØª Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†Ø§Ù‚Øµ Ø§Ù„Ø°ÙŠ ÙƒØ§Ù† ÙŠØ³Ø¨Ø¨ Ø§Ù„Ø®Ø·Ø£ -->
        <div class="deck" id="adviceDeck" style="display:none"></div>

        <!-- ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ -->
        <div class="emg emg-a" style="margin-top:14px">
          <h3 style="color:#b91c1c; font-family:'Amiri',serif; margin-bottom:8px">ğŸš‘ Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø£Ù…Ø§Ù…Ùƒ Ù…Ø±ÙŠØ¶ Ù‚Ù„Ø¨ ÙÙŠ Ø·Ø§Ø±Ø¦ØŸ</h3>
          <ul style="line-height:1.9; font-size:15px; color:#374151; padding-inline-start:22px; margin:0">
            <li><strong>Ø§ØªØµÙ„ ÙÙˆØ±Ù‹Ø§ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù</strong> (999 Ø£Ùˆ 112 Ø­Ø³Ø¨ Ø¨Ù„Ø¯Ùƒ).</li>
            <li>Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø±ÙŠØ¶ Ù†ØµÙ Ø¬Ù„ÙˆØ³ØŒ Ø®ÙÙ‘Ù Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ØŒ ÙˆÙÙ‘Ø± Ù‡ÙˆØ§Ø¡Ù‹ Ù†Ù‚ÙŠÙ‹Ø§.</li>
            <li>Ø¥Ù† ØªÙˆÙÙ‘Ø± Ø£Ø³Ø¨Ø±ÙŠÙ† 300Ù…Øº ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ­Ø³Ù‘Ø³: ÙŠÙÙ…Ø¶Øº Ø¨Ø¨Ø·Ø¡.</li>
            <li>Ø¥Ø°Ø§ ØªÙˆÙ‚Ù Ø§Ù„ØªÙ†ÙØ³/Ø§Ù„Ù†Ø¨Ø¶: Ø§Ø¨Ø¯Ø£ <strong>Ø§Ù„Ø¥Ù†Ø¹Ø§Ø´ Ø§Ù„Ù‚Ù„Ø¨ÙŠ Ø§Ù„Ø±Ø¦ÙˆÙŠ (CPR)</strong> Ø¶ØºØ·Ø§Øª 100â€“120/Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ù†ØªØµÙ Ø§Ù„ØµØ¯Ø±.</li>
          </ul>
        </div>

        <div class="emg emg-b" style="margin-top:10px">
          <h3 style="color:#92400e; font-family:'Amiri',serif; margin-bottom:8px">â¤ï¸ Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ø¥Ø°Ø§ Ø£ØµØ§Ø¨ØªÙƒ Ø´Ø®ØµÙŠÙ‹Ø§ Ø­Ø§Ù„Ø© Ù‚Ù„Ø¨ÙŠØ© Ø·Ø§Ø±Ø¦Ø©ØŸ</h3>
          <ul style="line-height:1.9; font-size:15px; color:#374151; padding-inline-start:22px; margin:0">
            <li>ØªÙˆÙ‚Ù ÙÙˆØ±Ù‹Ø§ ÙˆØ§Ø¬Ù„Ø³ Ø£Ùˆ Ø§Ø³ØªÙ„Ù‚Ù Ø¨ÙˆØ¶Ø¹ Ù…Ø±ÙŠØ­.</li>
            <li><strong>Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</strong> Ø£Ùˆ Ø§Ø·Ù„Ø¨ Ù…Ù† Ù…Ù† Ø­ÙˆÙ„Ùƒ Ø§Ù„Ø§ØªØµØ§Ù„.</li>
            <li>Ù„Ø§ ØªÙ‚Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¨Ù†ÙØ³Ùƒ. Ø¥Ù† ÙˆÙØµÙ Ù„Ùƒ Ø¯ÙˆØ§Ø¡ ØªØ­Øª Ø§Ù„Ù„Ø³Ø§Ù† (Ù†ÙŠØªØ±ÙˆØºÙ„ÙŠØ³Ø±ÙŠÙ†): Ø¶Ø¹ Ù‚Ø±ØµÙ‹Ø§ ÙƒÙ…Ø§ ÙˆØµÙ Ø§Ù„Ø·Ø¨ÙŠØ¨.</li>
            <li>Ø¥Ø°Ø§ Ù„Ù… ØªØªØ­Ø³Ù† Ø®Ù„Ø§Ù„ Ø¯Ù‚Ø§Ø¦Ù‚ Ø£Ùˆ Ø³Ø§Ø¡Øª: Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø¥Ø³Ø¹Ø§Ù ÙÙˆØ±Ù‹Ø§.</li>
          </ul>
        </div>

        <!-- Ù…Ø³ØªØ´ÙÙ‰ Ù…Ø­Ù„ÙŠ -->
        <div id="localBox" class="card" style="margin-top:12px; display:none">
          <h3>Ù…Ø³ØªØ´ÙÙ‰ Ù‚Ù„Ø¨ Ù…ÙˆØµÙ‰ Ø¨Ù‡ ÙÙŠ Ø¨Ù„Ø¯Ùƒ</h3>
          <div class="hint">Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ ÙŠØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ù…Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ.</div>
          <div id="localContact" style="margin-top:6px; font-size:14px; color:#374151"></div>
        </div>

        <!-- Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø¹Ø§Ù„Ù…ÙŠØ© -->
        <div class="card" style="margin-top:12px">
          <h3>Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù‚Ù„Ø¨ Ø¹Ø§Ù„Ù…ÙŠØ© Ù…ÙˆØ«ÙˆÙ‚Ø©</h3>
          <div class="hint">Ø§Ø®ØªØ± Ù…Ø³ØªØ´ÙÙ‰ Ù„Ù…Ø¹Ø±ÙØ© Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
          <div class="select">
            <select id="intlSelect" aria-label="Ø§Ø®ØªØ± Ù…Ø³ØªØ´ÙÙ‰ Ø¹Ø§Ù„Ù…ÙŠ">
              <option value="">â€” Ø§Ø®ØªØ± Ù…Ø³ØªØ´ÙÙ‰ Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§ â€”</option>
              <option data-phone="+1-216-444-2200" value="https://my.clevelandclinic.org/departments/heart">Cleveland Clinic â€” Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+1-507-284-2511" value="https://www.mayoclinic.org/departments-centers/cardiovascular-medicine/home/orc-20121930">Mayo Clinic Cardiovascular â€” Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+1-713-332-2539" value="https://www.houstonmethodist.org/heart-vascular/">Houston Methodist DeBakey â€” Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+44-20-7352-8121" value="https://www.rbht.nhs.uk/contact">Royal Brompton â€” Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+49-30-450-50" value="https://www.charite.de/en/deutsches_herzzentrum_der_charite_dhzc">Deutsches Herzzentrum â€” Ø£Ù„Ù…Ø§Ù†ÙŠØ§</option>
              <option data-phone="+65-6704-2000" value="https://www.nhcs.com.sg/appointments">National Heart Centre Singapore â€” Ø³Ù†ØºØ§ÙÙˆØ±Ø©</option>
              <option data-phone="+66-2066-8888" value="https://www.bumrungrad.com/en/contact-us/contact-details">Bumrungrad Heart Institute â€” ØªØ§ÙŠÙ„Ù†Ø¯</option>
              <option data-phone="+971-800-82223" value="https://www.clevelandclinicabudhabi.ae/en/institutes-and-specialties/heart-vascular-and-thoracic-institute">Cleveland Clinic Ø£Ø¨ÙˆØ¸Ø¨ÙŠ â€” Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
            </select>
          </div>
          <div id="intlContact" style="margin-top:8px; font-size:14px; color:#374151; display:none"></div>
        </div>

        <!-- Ù…Ø±Ø§Ø¬Ø¹ -->
        <div class="card" style="margin-top:12px">
          <h3>Ù…Ø±Ø§Ø¬Ø¹ Ù…ÙˆØ«ÙˆÙ‚Ø©</h3>
          <div class="hint">Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù„ÙŠÙ…ÙŠØ© ØªÙÙØªØ­ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
          <div class="select">
            <select id="refSelect" aria-label="Ø§Ø®ØªØ± Ù…Ø±Ø¬Ø¹Ù‹Ø§">
              <option value="">â€” Ø§Ø®ØªØ± Ù…Ø±Ø¬Ø¹Ù‹Ø§ â€”</option>
              <option value="https://www.who.int/health-topics/cardiovascular-diseases">Ù…Ù†Ø¸Ù…Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ ÙˆØ§Ù„Ø£ÙˆØ¹ÙŠØ©</option>
              <option value="https://www.heart.org/">Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ© Ù„Ù„Ù‚Ù„Ø¨</option>
              <option value="https://www.escardio.org/">Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø£ÙˆØ±ÙˆØ¨ÙŠØ© Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</option>
              <option value="https://www.nhs.uk/conditions/heart-disease/">Ø®Ø¯Ù…Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ© â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</option>
              <option value="https://www.cdc.gov/heartdisease/">Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ© Ù„Ù„Ø³ÙŠØ·Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</option>
              <option value="https://www.nice.org.uk/guidance">Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ù„ØªÙ…ÙŠÙ‘Ø² Ø§Ù„ØµØ­ÙŠ â€” Ø£Ø¯Ù„Ø©</option>
            </select>
          </div>
        </div>

        <!-- Ù…Ø´Ø§Ø±ÙƒØ© -->
        <div class="card" style="margin-top:12px; text-align:center">
          <h3>Ø´Ø§Ø±Ùƒ Ø§Ù„ØµÙØ­Ø©</h3>
          <div class="sharebar" style="display:flex; justify-content:center; gap:8px; flex-wrap:wrap">
            <a class="iconbtn" id="shareWA" title="ÙˆØ§ØªØ³Ø§Ø¨" aria-label="WhatsApp" href="https://wa.me/?text=%D9%81%D8%A7%D8%AD%D8%B5%20%D8%A3%D8%B9%D8%B1%D8%A7%D8%B6%20%D8%A7%D9%84%D9%82%D9%84%D8%A8%20https%3A%2F%2Fexample.com%2Fheart-checker-ar" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 0a12 12 0 00-10 18.3L1 23l4.9-1A12 12 0 1012 0zm6.5 17.2c-.3.8-1.7 1.6-2.4 1.6-.6 0-1.4.1-3.8-1-3.2-1.4-5.3-4.6-5.5-4.8-.1-.2-1.3-1.7-1.3-3.2 0-1.6.8-2.4 1.1-2.7.3-.3.7-.4 1-.4h.8c.2 0 .6 0 .9.7.3.8 1.1 2.7 1.2 2.9.1.2.2.5 0 .8-.2.3-.3.5-.6.8-.3.3-.6.6-.2 1.2.4.6 1.7 2.8 4 3.8 2.9 1.2 3 .8 3.5.8.5 0 1.8-.8 2.1-1.5.2-.7 1-1.6 1.3-1.8.2-.1.3-.2.5-.1l1 .5c.3.1.5.3.5.5-.1.4-.7 2-1 2.7z"/></svg>
            </a>
            <a class="iconbtn" id="shareTG" title="ØªÙŠÙ„ÙŠØºØ±Ø§Ù…" aria-label="Telegram" href="https://t.me/share/url?url=https%3A%2F%2Fexample.com%2Fheart-checker-ar&text=%D9%81%D8%A7%D8%AD%D8%B5%20%D8%A3%D8%B9%D8%B1%D8%A7%D8%B6%20%D8%A7%D9%84%D9%82%D9%84%D8%A8" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M9 18.2l-.3 4.1c.4 0 .6-.2.8-.4l2-1.8 4.1 3c.7.4 1.3.2 1.5-.7L22 6.2c.2-1.1-.4-1.5-1.1-1.2L2.3 11.1c-1.1.4-1 1.3 0 1.6Ù„4.1 1.2 9.4-5.9c.4-.3.9-.1.5.2L9 18.2z"/></svg>
            </a>
            <a class="iconbtn" id="shareX" title="X" aria-label="X" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fexample.com%2Fheart-checker-ar&text=%D9%81%D8%A7%D8%AD%D8%B5%20%D8%A3%D8%B9%D8%B1%D8%A7%D8%B6%20%D8%A7%D9%84%D9%82%D9%84%D8%A8" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 2h4.7l5 6.8L18.7 2H22Ù„-7.8 9.1L22 22h-4.8l-5.4-7.2L6 22H2.1l8.3-9.8L3 2z"/></svg>
            </a>
            <a class="iconbtn" id="shareFB" title="Facebook" aria-label="Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fexample.com%2Fheart-checker-ar" target="_blank" rel="noopener">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M22 12a10 10 0 10-11.6 9.9v-7H7.7V12h2.7V9.8c0-2.7 1.6-4.2 4-4.2 1.2 0 2.5.2 2.5.2v2.7h-1.4c-1.4 0-1.9.9-1.9 1.8V12Ù‡3.2l-.5 2.9h-2.7v7A10 10 0 0022 12z"/></svg>
            </a>
            <button class="iconbtn" id="copyLink" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·" aria-label="Copy Link">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M16 1H8C6.3 1 5 2.3 5 4v12c0 1.7 1.3 3 3 3h8c1.7 0 3-1.3 3-3V4c0-1.7-1.3-3-3-3zm1 15c0 .6-.4 1-1 1H8c-.6 0-1-.4-1-1V4c0-.6.4-1 1-1h8c.6 0 1 .4 1 1v12Ø²M7 20c0 .6.4 1 1 1h8v2H8c-1.7 0-3-1.3-3-3v-2h2v2z"/></svg>
            </button>
          </div>
          <div class="hint">Ø¥Ø°Ø§ Ù„Ù… ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ØŒ Ø§Ù„Ø²Ø± ÙŠÙ†Ø³Ø® Ø§Ù„Ù†Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„ØªÙ„ØµÙ‚Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.</div>
        </div>

        <footer style="text-align:center; margin:10px 0 0; font-size:12px; color:#6b7280">
          <!-- Ø²Ø± Ø®ÙÙŠ: Ù„Ø§ ÙŠØ¨Ø¯Ùˆ Ø±Ø§Ø¨Ø·Ù‹Ø§ØŒ Ù„ÙƒÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø°ÙŠ Ø£Ø±Ø³Ù„ØªÙ‡ -->
          <button id="devLinkBtn" type="button">Ø¨Ø±Ù…Ø¬Ø© ÙˆØªØ·ÙˆÙŠØ±: ÙØ§Ø¶Ù„ Ø§Ù„Ø±ÙŠØ³</button>
        </footer>
      </div>
    </div>
  </section>
</main>

<!-- Ù†Ø§ÙØ°Ø© Ø±Ø³Ø§Ø¦Ù„ -->
<div id="msgBackdrop" class="msg-backdrop" role="dialog" aria-modal="true" aria-labelledby="msgTitle">
  <div id="msgBox" class="msg-box">
    <div id="msgTitle" class="msg-title">Ù…Ø¹Ù„ÙˆÙ…Ø©</div>
    <div id="msgText" class="msg-text">â€”</div>
    <div class="msg-actions">
      <button id="msgRetry" class="msg-ghost" style="display:none">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
      <button id="msgOk" class="msg-btn">Ø­Ø³Ù†Ù‹Ø§</button>
    </div>
  </div>
</div>

<!-- PDF & Ù…Ø´Ø§Ø±ÙƒØ© -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
<script>
/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
const $mb=document.getElementById('msgBackdrop');
const $box=document.getElementById('msgBox');
const $txt=document.getElementById('msgText');
const $ttl=document.getElementById('msgTitle');
const $retry=document.getElementById('msgRetry');
document.getElementById('msgOk').onclick=()=>{$mb.classList.remove('show'); $retry.style.display='none'};
function openMsg(message,type='info',title,withRetry=false,retryFn=null){
  $txt.innerHTML=message;
  $ttl.textContent=title||(type==='error'?'ØªØ¹Ø°Ù‘Ø± Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©':'Ù…Ø¹Ù„ÙˆÙ…Ø©');
  $box.classList.toggle('error', type==='error');
  $mb.classList.add('show');
  if(withRetry && typeof retryFn==='function'){
    $retry.style.display='inline-flex';
    $retry.onclick=()=>{ $mb.classList.remove('show'); $retry.style.display='none'; retryFn(); };
  }else{
    $retry.style.display='none';
  }
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ */
function makeToggle(segId,dataKey){
  const seg=document.getElementById(segId);
  seg.addEventListener('click', e=>{
    const b=e.target.closest('button'); if(!b) return;
    seg.querySelectorAll('button').forEach(x=>x.classList.remove('on'));
    b.classList.add('on');
    seg.dataset[dataKey]=Object.values(b.dataset)[0];
  });
}
makeToggle('sexSeg','sex'); makeToggle('smokeSeg','smoke'); makeToggle('familySeg','fh'); makeToggle('genSeg','gen');

/* Ù†Ø¹Ù…/Ù„Ø§ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© */
document.getElementById('symptoms').addEventListener('click', e=>{
  const btn=e.target.closest('button'); if(!btn) return;
  const seg=btn.parentElement;
  seg.querySelectorAll('button').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
});

/* ÙØªØ­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… */
const refSelect=document.getElementById('refSelect');
refSelect&&refSelect.addEventListener('change', e=>{
  const url=e.target.value; if(url){ window.open(url,'_blank','noopener'); e.target.value=''; }
});

/* Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø¹Ø§Ù„Ù…ÙŠØ© */
const intlSelect=document.getElementById('intlSelect');
const intlContact=document.getElementById('intlContact');
intlSelect.addEventListener('change', ()=>{
  const opt=intlSelect.selectedOptions[0];
  if(!opt||!opt.value){ intlContact.style.display='none'; intlContact.innerHTML=''; return; }
  const phone=(opt.dataset.phone||'').replace(/\s+/g,'');
  const telLocal=phone?`tel:${phone}`:'';
  const url=opt.value;
  const name=opt.textContent.split('â€”')[0].trim();
  intlContact.innerHTML=`${phone?`ğŸ“ <a href="${telLocal}"><strong>${opt.dataset.phone}</strong></a>`:'ğŸ“ â€”'} &nbsp;â€”&nbsp; <a href="${url}" target="_blank" rel="noopener">Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹ ${name}</a>`;
  intlContact.style.display='block';
});

/* Ù…Ø³ØªØ´ÙÙŠØ§Øª Ù…Ø­Ù„ÙŠØ© (Ù…Ø®ØªØµØ±Ø© â€” ÙŠÙ…ÙƒÙ†Ùƒ Ø¶Ø¨Ø·Ù‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ø¯Ù‚Ø© Ø£ÙƒØ¨Ø±) */
const COUNTRY_HOSPITALS={
  BHR:{n:"Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø³Ù„Ù…Ø§Ù†ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠ â€” Ù‚Ø³Ù… Ø§Ù„Ù‚Ù„Ø¨", phone:"+973-17288888", url:"https://www.moh.gov.bh/Contact/SMC?lang=ar"},
  KSA:{n:"Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ Ø§Ù„Ø·Ø¨ÙŠØ© â€” Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ù„Ø¨", phone:"+966-11-288-9999", url:"https://www.kfmc.med.sa"},
  ARE:{n:"ÙƒÙ„ÙŠÙÙ„Ø§Ù†Ø¯ ÙƒÙ„ÙŠÙ†Ùƒ Ø£Ø¨ÙˆØ¸Ø¨ÙŠ â€” Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ù‚Ù„Ø¨ ÙˆØ§Ù„Ø£ÙˆØ¹ÙŠØ©", phone:"+971-800-82223", url:"https://www.clevelandclinicabudhabi.ae/en/institutes-and-specialties/heart-vascular-and-thoracic-institute"},
  QAT:{n:"Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚Ù„Ø¨ â€” Ù…Ø¤Ø³Ø³Ø© Ø­Ù…Ø¯ Ø§Ù„Ø·Ø¨ÙŠØ©", phone:"+974-4025-1111", url:"https://hamad.qa"},
  KWT:{n:"Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„ØµØ¯Ø±ÙŠØ© â€” ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚Ù„Ø¨", phone:"+965-24844040", url:"https://www.moh.gov.kw/"},
  OMN:{n:"Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ù„Ù‚Ù„Ø¨ â€” Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø³Ù„Ø·Ø§Ù†ÙŠ", phone:"+968-24599000", url:"https://www.royalhospital.om/"},
  JOR:{n:"Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø­Ø³ÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠØ© â€” Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ù„Ø¨", phone:"+962-6-5804800", url:"https://www.rms.jo/"},
  LBN:{n:"AUBMC â€” Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ù„Ø¨", phone:"+961-1-350000", url:"https://www.aubmc.org.lb/"},
  PSE:{n:"Ù…Ø¬Ù…Ø¹ ÙÙ„Ø³Ø·ÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠ â€” ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚Ù„Ø¨", phone:"+970-2-2965600", url:"https://www.moh.ps/"},
  SYR:{n:"Ù…Ø´ÙÙ‰ Ø§Ù„Ø£Ø³Ø¯ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨", phone:"+963-11-3340", url:"http://moh.gov.sy/"},
  IRQ:{n:"Ù…Ø±ÙƒØ² Ø§Ø¨Ù† Ø§Ù„Ø¨ÙŠØ·Ø§Ø± Ù„Ø¬Ø±Ø§Ø­Ø© Ø§Ù„Ù‚Ù„Ø¨", phone:"+964-1-0000000", url:"https://moh.gov.iq/"},
  EGY:{n:"Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ù‚Ù„Ø¨ (NHIC)", phone:"+20-2-27948030", url:"http://www.nhic.gov.eg/"},
  SDN:{n:"Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø´Ø¹Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ â€” Ø§Ù„Ù‚Ù„Ø¨", phone:"+249-183-000000", url:"https://fmoh.gov.sd/"},
  SOM:{n:"Ù…Ø³ØªØ´ÙÙ‰ Ù…Ø¯ÙŠØ¬Ùˆ â€” Ø§Ù„Ù‚Ù„Ø¨", phone:"+252-61-0000000", url:""},
  DJI:{n:"Ù…Ø³ØªØ´ÙÙ‰ Ø¨ÙŠÙ„ØªÙŠÙŠÙ‡ â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨", phone:"+253-21350000", url:"https://www.sante.gouv.dj/"},
  COM:{n:"Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙˆØ·Ù†ÙŠ â€” Ù‚Ø³Ù… Ø§Ù„Ù‚Ù„Ø¨", phone:"+269-3210000", url:""},
  MRT:{n:"Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙˆØ·Ù†ÙŠ â€” ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚Ù„Ø¨", phone:"+222-45000000", url:""},
  MAR:{n:"Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„ÙˆØ·Ù†ÙŠ Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ â€” Ø§Ù„Ø±Ø¨Ø§Ø·", phone:"+212-537-771700", url:"https://www.sante.gov.ma/"},
  DZA:{n:"Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ù„Ø¨ â€” CHU", phone:"+213-21-239000", url:""},
  TUN:{n:"Ù…Ø¹Ù‡Ø¯ ØµØ§Ù„Ø­ Ø¹Ø²ÙŠÙ‘Ø² â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨", phone:"+216-71783022", url:""},
  LBA:{n:"Ù…Ø±ÙƒØ² Ø·Ø±Ø§Ø¨Ù„Ø³ Ø§Ù„Ù‚Ù„Ø¨ÙŠ", phone:"+218-21-0000000", url:""},
  YEM:{n:"Ù…Ø±ÙƒØ² Ø§Ù„Ù‚Ù„Ø¨ â€” Ø§Ù„ÙŠÙ…Ù†", phone:"+967-1-000000", url:""},
  IRN:{n:"Ù…Ø±ÙƒØ² Ø·Ù‡Ø±Ø§Ù† Ø§Ù„Ù‚Ù„Ø¨ÙŠ â€” Ø¬Ø§Ù…Ø¹Ø© Ø·Ù‡Ø±Ø§Ù†", phone:"+98-21-88029111", url:"https://thc.tums.ac.ir/"}
};
const EXTRA_HOSPITALS={
  QAT:[
    {n:"National Heart Center (HMC)", phone:"+974-44395777", url:"https://hamad.qa"},
    {n:"Sidra Medicine â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨", phone:"+974-40034000", url:"https://www.sidra.org/"}
  ],
  IRN:[
    {n:"Ù…Ø±ÙƒØ² Ø±Ø¬Ø§Ø¦ÙŠ Ù„Ø£Ù…Ø±Ø§Ø¶ ÙˆØ¬Ø±Ø§Ø­Ø© Ø§Ù„Ù‚Ù„Ø¨", phone:"+98-21-23922000", url:"https://www.rhc.ac.ir/"},
    {n:"Ù…Ø³ØªØ´ÙÙ‰ Ø´Ø±ÙŠØ¹ØªÙŠ â€” Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨", phone:"+98-21-84902000", url:"https://shariati.tums.ac.ir/"}
  ]
};

/* Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®Ø·ÙˆØ±Ø© */
const QUESTIONS_IDS=["chestpain","sob","palp","edema","acs","rad","rf","postcovid"];
function isYes(id){ return document.querySelector(`.seg[data-q="${id}"] .on`)?.dataset.a==='yes'; }
function computeRisk(){
  let score=0;
  const heavy=['acs','chestpain'];
  QUESTIONS_IDS.forEach(id=>{
    const seg=document.querySelector(`.seg[data-q="${id}"]`);
    const a=seg.querySelector('button.on')?.dataset.a||'no';
    if(a==='yes'){ score+=1; if(heavy.includes(id)) score+=2; }
  });
  if((document.getElementById('smokeSeg').dataset.smoke||'no')==='yes') score+=1;
  if((document.getElementById('familySeg').dataset.fh||'no')==='yes') score+=1;
  if((document.getElementById('genSeg').dataset.gen||'no')==='yes') score+=1;
  if(score>10) score=10;

  let levelText='Ù…Ù†Ø®ÙØ¶Ø©', cls='rb-ok', action='Ø±Ø§Ù‚Ø¨ Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„ØªØ²Ù… Ø¨Ù†Ù…Ø· Ø­ÙŠØ§Ø© Ù‚Ù„Ø¨ÙŠ ØµØ­ÙŠ.';
  if(isYes('acs') || (isYes('chestpain') && isYes('sob'))){
    levelText='Ø¹Ø§Ù„ÙŠØ©'; cls='rb-danger'; action='Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø£Ùˆ Ø±Ø§Ø¬Ø¹ Ø£Ù‚Ø±Ø¨ Ø·ÙˆØ§Ø±Ø¦ ÙÙˆØ±Ù‹Ø§.';
  }else if(isYes('palp') || isYes('edema') || isYes('rad')){
    levelText='Ù…ØªÙˆØ³Ø·Ø©'; cls='rb-warn'; action='Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ù‹Ø§ Ù„Ø¯Ù‰ Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù‚Ù„Ø¨/Ø§Ù„Ø£Ø³Ø±Ø© Ø®Ù„Ø§Ù„ 1â€“3 Ø£ÙŠØ§Ù… Ù„Ù„ØªÙ‚ÙŠÙŠÙ….';
  }
  if(score>=6){ levelText='Ø¹Ø§Ù„ÙŠØ©'; cls='rb-danger'; action='ØªÙ‚ÙŠÙŠÙ… Ø¹Ø§Ø¬Ù„ Ø®Ù„Ø§Ù„ 24â€“72 Ø³Ø§Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø¥Ø°Ø§ Ø³Ø§Ø¡Øª Ø§Ù„Ø­Ø§Ù„Ø©.'; }
  return {levelText, cls, action, score};
}

/* ÙØ­ÙˆØµ ÙˆÙ†ØµØ§Ø¦Ø­ */
function screening(age,sex,smoker,fh,gen){
  const list=[];
  list.push("Ù‚ÙŠØ§Ø³ Ø¶ØºØ· Ø§Ù„Ø¯Ù… Ø³Ù†ÙˆÙŠÙ‹Ø§ (Ø£Ùˆ ÙˆÙÙ‚ Ù†ØµÙŠØ­Ø© Ø§Ù„Ø·Ø¨ÙŠØ¨).");
  list.push("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù‡ÙˆÙ† ÙˆØ§Ù„Ø³ÙƒØ± (ØµØ§Ø¦Ù…/ØªØ±Ø§ÙƒÙ…ÙŠ) ÙƒÙ„ 1â€“3 Ø³Ù†ÙˆØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·ÙˆØ±Ø©.");
  if(smoker==='yes') list.push("Ø§Ù„Ø¥Ù‚Ù„Ø§Ø¹ Ø¹Ù† Ø§Ù„ØªØ¨Øº + Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¯Ø¹Ù…/Ø¨Ø¯Ø§Ø¦Ù„ Ù†ÙŠÙƒÙˆØªÙŠÙ†.");
  if(fh==='yes') list.push("ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù…Ø¨ÙƒØ±: ÙØ­Øµ Ø§Ù„Ø´Ø­ÙˆÙ… Ø§Ù„Ù…Ø¨ÙƒØ± ÙˆÙØ­ÙˆØµ Ø£Ù‚Ø§Ø±Ø¨ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.");
  if(gen==='yes') list.push("ÙˆØ±Ø§Ø«Ø© Ø¯Ù‚ÙŠÙ‚Ø©: Ø¥Ø­Ø§Ù„Ø© Ù„Ø·Ø¨/Ù‚Ù„Ø¨ ÙˆØ±Ø§Ø«ÙŠ.");
  if(age>=40) list.push("ØªÙ‚ÙŠÙŠÙ… Ø®Ø·Ø± Ø§Ù„ØªØµÙ„Ù‘Ø¨ (ASCVD) ÙˆÙ…Ù†Ø§Ù‚Ø´Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¨.");
  return list;
}
function buildAdvice(age,sex,smoke,fh,gen){
  const deck=document.getElementById('adviceDeck');
  if(!deck){ console.warn('adviceDeck Ù…ÙÙ‚ÙˆØ¯'); return; }
  deck.innerHTML='';
  const mk=(t,html)=>{ const e=document.createElement('div'); e.className='card'; e.innerHTML=`<h3>${t}</h3>${html}`; return e; };
  const list=screening(age,sex,smoke,fh,gen);
  deck.append(
    mk('Ù†ØµØ§Ø¦Ø­ Ø³Ø±ÙŠØ¹Ø©','<ul><li>Ø£ÙŠ Ø£Ù„Ù… ØµØ¯Ø±ÙŠ Ø¶Ø§ØºØ· Ø£Ùˆ Ø¶ÙŠÙ‚ Ù†ÙØ³ Ø´Ø¯ÙŠØ¯ = Ø·ÙˆØ§Ø±Ø¦.</li><li>Ø§Ù…ØªÙ†Ø¹ Ø¹Ù† Ø§Ù„ØªØ¨ØºØŒ ÙˆÙ†Ù… 7â€“8 Ø³Ø§Ø¹Ø§ØªØŒ ÙˆØªØ­Ø±Ùƒ 150â€“300 Ø¯Ù‚ÙŠÙ‚Ø©/Ø£Ø³Ø¨ÙˆØ¹.</li><li>Ù†Ø¸Ø§Ù… Ù…ØªÙˆØ³Ø·ÙŠ: Ø®Ø¶Ø§Ø±ØŒ ÙÙˆØ§ÙƒÙ‡ØŒ Ø­Ø¨ÙˆØ¨ ÙƒØ§Ù…Ù„Ø©ØŒ Ø£Ø³Ù…Ø§ÙƒØŒ Ø²ÙŠØª Ø²ÙŠØªÙˆÙ†.</li></ul>'),
    mk('ÙØ­ÙˆØµ Ù…Ù‚ØªØ±Ø­Ø©', '<ul>'+list.map(x=>`<li>${x}</li>`).join('')+'</ul>')
  );
  deck.style.display='grid';
}

/* Ù†ØªÙŠØ¬Ø© + PDF + Ø±Ø³Ø§Ø¦Ù„ ÙˆØ§Ø¶Ø­Ø© */
let lastResult=null;
const calcBtn=document.getElementById('calc');
calcBtn.addEventListener('click', ()=>{
  try{
    const ageVal=document.getElementById('age').value.trim();
    if(ageVal===''){
      openMsg('Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¹Ù…Ø± Ø¨Ø¹Ø¯. Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªÙŠØ¬Ø©: Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø±Ù‹Ø§ (1â€“120) Ø«Ù… Ø§Ø¶ØºØ· "Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©".', 'error', 'Ø§Ù„Ø¹Ù…Ø± Ù…Ø·Ù„ÙˆØ¨', true, ()=>calcBtn.click());
      return;
    }
    const age=parseFloat(ageVal);
    if(!(age>=1 && age<=120)){
      openMsg('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø±Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§ Ø¨ÙŠÙ† 1 Ùˆ 120.', 'error', 'Ù‚ÙŠÙ…Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©', true, ()=>calcBtn.click());
      return;
    }
    const sex=document.getElementById('sexSeg').dataset.sex||'male';
    const smoke=document.getElementById('smokeSeg').dataset.smoke||'no';
    const fh=document.getElementById('familySeg').dataset.fh||'no';
    const gen=document.getElementById('genSeg').dataset.gen||'no';

    const {levelText, cls, action, score}=computeRisk();
    const box=document.getElementById('resultBox');
    box.className='resultbox '+cls;
    document.getElementById('riskText').textContent=levelText;
    document.getElementById('actionText').textContent=action;
    box.style.display='block';

    buildAdvice(age,sex,smoke,fh,gen);

    // Ù…Ø³ØªØ´ÙÙ‰ Ø¨Ù„Ø¯Ùƒ
    const ccode=document.getElementById('countrySelect').value;
    const loc=COUNTRY_HOSPITALS[ccode];
    const localBox=document.getElementById('localBox');
    const localContact=document.getElementById('localContact');
    if(loc){
      const telHref = loc.phone ? `tel:${loc.phone.replace(/\s+/g,'')}` : '';
      let extraHtml='';
      if(EXTRA_HOSPITALS[ccode]){
        extraHtml = '<div style="margin-top:8px"><strong>Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ©:</strong><ul style="margin:6px 0 0 0; padding-inline-start:20px">';
        EXTRA_HOSPITALS[ccode].forEach(h=>{
          const tel = h.phone?`tel:${(h.phone||'').replace(/\s+/g,'')}`:'';
          extraHtml += `<li>${h.n} â€” ${h.phone?`ğŸ“ <a href="${tel}">${h.phone}</a>`:'â€”'} ${h.url?`&nbsp;â€”&nbsp;<a href="${h.url}" target="_blank" rel="noopener">Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>`:''}</li>`;
        });
        extraHtml += '</ul></div>';
      }
      localContact.innerHTML = `
        ğŸ¥ <strong>${loc.n}</strong><br>
        ${loc.phone ? `ğŸ“ <a href="${telHref}"><strong>${loc.phone}</strong></a>` : 'ğŸ“ â€”'}
        &nbsp;â€”&nbsp; ${loc.url ? `<a href="${loc.url}" target="_blank" rel="noopener">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</a>` : ''}
        ${extraHtml}
      `;
      localBox.style.display='block';
    }else{
      localBox.style.display='none';
      localContact.innerHTML='';
    }

    // Ù…Ø³ØªØ´ÙÙ‰ Ø¹Ø§Ù„Ù…ÙŠ Ù…Ø®ØªØ§Ø±
    const sel=document.getElementById('intlSelect');
    if(sel.value){
      const opt=sel.selectedOptions[0];
      const phone=opt.dataset.phone||'';
      const tel=phone?`tel:${phone.replace(/\s+/g,'')}`:'';
      const url=sel.value;
      const name=opt.textContent.split('â€”')[0].trim();
      intlContact.innerHTML=`${phone?`ğŸ“ <a href="${tel}"><strong>${phone}</strong></a>`:'ğŸ“ â€”'} &nbsp;â€”&nbsp; <a href="${url}" target="_blank" rel="noopener">Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹ ${name}</a>`;
      intlContact.style.display='block';
    }else{
      intlContact.style.display='none';
      intlContact.innerHTML='';
    }

    // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„ØªØµØ¯ÙŠØ±
    lastResult = {
      country: document.querySelector('#countrySelect option:checked').textContent,
      age, sex:(sex==='male'?'Ø±Ø¬Ù„':'Ø§Ù…Ø±Ø£Ø©'),
      smoke:(smoke==='yes'?'Ù…Ø¯Ø®Ù‘Ù†':'ØºÙŠØ± Ù…Ø¯Ø®Ù‘Ù†'),
      fh:(fh==='yes'?'ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù…Ø¨ÙƒØ±':'Ù„Ø§'),
      gen:(gen==='yes'?'ÙˆØ±Ø§Ø«Ø© Ø¯Ù‚ÙŠÙ‚Ø©: Ù…ÙˆØ¬ÙˆØ¯Ø©':'Ù„Ø§'),
      level:levelText, action, score
    };
    document.getElementById('pdfwrap').style.display='block';
  }catch(err){
    // ÙŠØ¸Ù‡Ø± Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£ ÙØ¹Ù„ÙŠ
    openMsg('Ø­Ø¯Ø«Øª Ù…Ø´ÙƒÙ„Ø© ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø© Ø£Ø«Ù†Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©. Ø¬Ø±Ù‘Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©. Ø¥Ù† Ø§Ø³ØªÙ…Ø±Øª Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŒ Ø­Ø¯Ù‘Ø« Ø§Ù„ØµÙØ­Ø©.', 'error', 'Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹', true, ()=>calcBtn.click());
    console.error(err);
  }
});

/* PDF */
document.getElementById('pdfBtn').addEventListener('click', async ()=>{
  if(!lastResult){ openMsg('Ø£Ø¬Ø¨ Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø£ÙˆÙ„Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø«Ù… ØªÙ†Ø²ÙŠÙ„Ù‡Ø§ PDF.', 'error'); return; }
  const { jsPDF } = window.jspdf;
  const box=document.createElement('div');
  box.setAttribute('dir','rtl');
  box.style.width='780px'; box.style.background='#fff'; box.style.border='1px solid #e5e7eb'; box.style.borderRadius='16px'; box.style.padding='20px'; box.style.fontFamily='"Cairo",sans-serif'; box.style.color='#111827';
  function row(k,v){ return `<tr><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6"><strong>${k}</strong></td><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6">${v}</td></tr>`; }
  box.innerHTML=`
    <div style="text-align:center; margin-bottom:10px">
      <div style="font-family:'Amiri',serif; font-size:26px; color:${getComputedStyle(document.documentElement).getPropertyValue('--gold')}">ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</div>
      <div style="font-size:12px; color:#6b7280">${new Date().toLocaleString('ar')}</div>
    </div>
    <table style="width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid #eee; margin-bottom:10px">
      <thead><tr style="background:linear-gradient(90deg,#fff7e6,#fff)"><th style="padding:10px 12px; text-align:right">Ø§Ù„Ø¨Ù†Ø¯</th><th style="padding:10px 12px; text-align:right">Ø§Ù„Ù‚ÙŠÙ…Ø©</th></tr></thead>
      <tbody>
        ${row('Ø§Ù„Ø¯ÙˆÙ„Ø©', lastResult.country)}
        ${row('Ø§Ù„Ø¹Ù…Ø±', lastResult.age)}
        ${row('Ø§Ù„Ù†ÙˆØ¹', lastResult.sex)}
        ${row('Ø§Ù„ØªØ¯Ø®ÙŠÙ†', lastResult.smoke)}
        ${row('ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ/ÙˆØ±Ø§Ø«Ø©', `${lastResult.fh} â€” ${lastResult.gen}`)}
        ${row('Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©', lastResult.level + ` (Ø§Ù„Ø¯Ø±Ø¬Ø©: ${lastResult.score}/10)`)}
        ${row('Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ø¢Ù†', lastResult.action)}
      </tbody>
    </table>
    <div style="margin-top:10px; font-size:12px; color:#6b7280">Ù‡Ø°Ù‡ Ù†ØªÙŠØ¬Ø© ØªØ«Ù‚ÙŠÙÙŠØ© Ø¹Ø§Ù…Ø© ÙˆÙ„ÙŠØ³Øª ØªØ´Ø®ÙŠØµÙ‹Ø§ Ø·Ø¨ÙŠÙ‹Ø§. Ø§ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ø³Ø¹Ø§Ù Ø¹Ù†Ø¯ Ø£Ø¹Ø±Ø§Ø¶ Ø·Ø§Ø±Ø¦Ø©.</div>
  `;
  document.body.appendChild(box);
  await new Promise(r=>setTimeout(r, 80));
  const canvas = await html2canvas(box, {scale:2, useCORS:true});
  document.body.removeChild(box);

  const pdf = new jsPDF({orientation:'p', unit:'pt', format:'a4'});
  const pageW = pdf.internal.pageSize.getWidth();
  const pageH = pdf.internal.pageSize.getHeight();
  const margin = 28;
  const imgW = pageW - margin*2;
  const imgH = canvas.height * (imgW / canvas.width);

  if(imgH <= pageH - margin*2){
    pdf.addImage(canvas.toDataURL('image/png'), 'PNG', margin, margin, imgW, imgH);
  }else{
    let sH = pageH - margin*2, ratio = canvas.width / imgW, slice = sH * ratio, pos = 0;
    while(pos < canvas.height){
      const sliceCanvas = document.createElement('canvas');
      sliceCanvas.width = canvas.width;
      sliceCanvas.height = Math.min(slice, canvas.height - pos);
      sliceCanvas.getContext('2d').drawImage(canvas, 0, pos, canvas.width, sliceCanvas.height, 0, 0, sliceCanvas.width, sliceCanvas.height);
      const sliceData = sliceCanvas.toDataURL('image/png');
      if(pos>0) pdf.addPage();
      pdf.addImage(sliceData,'PNG', margin, margin, imgW, (sliceCanvas.height / ratio));
      pos += slice;
    }
  }
  pdf.save('Ù†ØªÙŠØ¬Ø©-Ø§Ø³ØªØ¨ÙŠØ§Ù†-Ø§Ù„Ù‚Ù„Ø¨.pdf');
});

/* Ù…Ø´Ø§Ø±ÙƒØ© + Ø¥ØµÙ„Ø§Ø­ ÙˆØ§ØªØ³Ø§Ø¨ (ÙŠÙ†Ø³Ø® Ø§Ù„Ù†Øµ Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ù„ÙØªØ­) */
document.getElementById('copyLink').onclick=async (e)=>{
  e.preventDefault();
  try{ await navigator.clipboard.writeText(location.href); openMsg('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙØ­Ø© â€” Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨.'); }
  catch{ openMsg('Ù„Ù… ÙŠØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ â€” Ø§Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠÙ‹Ø§.', 'error'); }
};
document.getElementById('shareWA').addEventListener('click', async ()=>{
  setTimeout(async ()=>{
    if(document.hasFocus()){
      try{
        const text=`ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ ${location.href}`;
        await navigator.clipboard.writeText(text);
        openMsg('ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ù‚Ø¯ Ù„Ø§ ÙŠÙƒÙˆÙ† Ù…Ø¯Ø¹ÙˆÙ…Ù‹Ø§ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø². Ù†Ø³Ø®Ù†Ø§ Ø§Ù„Ø±Ø³Ø§Ù„Ø© â€” Ø§Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨ ÙŠØ¯ÙˆÙŠÙ‹Ø§.');
      }catch{
        openMsg('Ø¥Ù† Ù„Ù… ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ØŒ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ¯ÙˆÙŠÙ‹Ø§ ÙˆØ§Ù„ØµÙ‚Ù‡ ÙÙŠ ÙˆØ§ØªØ³Ø§Ø¨.', 'error');
      }
    }
  }, 400);
});

/* Ø²Ø± Ø§Ù„Ù…Ø·ÙˆØ± â€” Ù„Ø§ ÙŠØ¸Ù‡Ø± ÙƒØ±Ø§Ø¨Ø·ØŒ Ù„ÙƒÙ†Ù‡ ÙŠÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· ÙÙ‚Ø· */
document.getElementById('devLinkBtn').addEventListener('click', ()=>{
  const url="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0&wame_ctl=1&fbclid=PAT01DUAM7l4pleHRuA2FlbQIxMAABpwJGnDp7WfAHhqRoa_qpGrhg7GIMSgPMIRoSG6soArRWJ5EgIqPqQd_19r5-_aem_p13zwEhkcUR1Z56-MA-c6g";
  window.open(url, '_blank', 'noopener');
});
</script>
</body>
</html>
