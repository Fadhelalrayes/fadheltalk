<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تذكرتك | قارن أسعار التذاكر</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f9fafb; --card:#fff; --ink:#0f172a; --muted:#6b7280; --line:#e5e7eb;
      --brand:#0ea5e9; --brand2:#0284c7; --shadow:0 12px 30px rgba(2,132,199,.12);
      --radius:18px; --ring:0 0 0 3px rgba(14,165,233,.25);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:'Cairo',serif}
    header{background:#fff;border-bottom:1px solid var(--line)}
    .container{max-width:980px;margin:auto;padding:20px 16px}
    .brand{text-align:center;margin-top:6px}
    .brand .title{font-weight:900;font-size:32px;color:var(--brand)}
    .brand .tag{margin-top:6px;color:#374151;font-weight:700}

    form.search{display:grid;gap:12px;margin-top:18px}
    .mode{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    .chip{display:flex;align-items:center;gap:8px;background:#fff;border:2px solid var(--line);border-radius:999px;padding:8px 14px;cursor:pointer;box-shadow:var(--shadow)}
    .chip input{accent-color:#0ea5e9}

    .fld{background:var(--card);border:2px solid var(--line);border-radius:18px;padding:14px 16px;box-shadow:var(--shadow)}
    .fld:focus-within{border-color:var(--brand);box-shadow:var(--shadow),var(--ring)}
    .lbl{font-size:13px;color:var(--muted);margin-bottom:6px}
    .hint{font-size:12px;color:#64748b;margin-top:4px}
    input[type=text], input[type=search], input[type=date], input[type=number], select{
      width:100%;border:0;outline:none;background:transparent;font-size:18px;padding:8px 0;color:var(--ink)
    }
    input[type=date]{font-size:16px;padding:6px}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .cta{
      width:100%;background:linear-gradient(180deg,var(--brand),var(--brand2));color:#fff;
      border:0;border-radius:18px;padding:16px;font-weight:900;cursor:pointer;font-size:18px;box-shadow:var(--shadow)
    }
    .cta:hover{filter:brightness(.98)}

    footer{margin:22px auto 10px;max-width:980px;padding:0 16px;text-align:center}
    .disclaimer{
      font-size:15px;color:#1f2937;background:linear-gradient(180deg,#fefefe,#f1f5f9);
      border:1px solid #e2e8f0;border-radius:14px;padding:16px 20px;margin-bottom:14px;
      line-height:1.9;text-align:justify;box-shadow:0 4px 10px rgba(0,0,0,.05)
    }
    .disclaimer strong{color:#d97706}
    .disclaimer::before{content:"⚠️ ";font-size:20px;vertical-align:middle;margin-left:4px}
    .social{margin-bottom:12px}
    .social a{display:inline-block;margin:0 6px;width:28px;height:28px}
    .social img{width:100%;height:100%;object-fit:contain;filter:grayscale(20%);transition:.2s}
    .social img:hover{filter:none;transform:scale(1.1)}
    .credit{font-size:16px;color:#475569;margin-top:10px}
    .credit a{color:#0ea5e9;text-decoration:none;font-weight:900}
    .credit a:hover{text-decoration:underline}
  </style>
</head>
<body>
  <header>
    <div class="container">
      <div class="brand">
        <div class="title">تذكرتك</div>
        <div class="tag">استكشف أرخص أسعار تذاكر الطيران</div>
      </div>

      <form class="search" onsubmit="event.preventDefault(); openSelected();">
        <!-- نمط الرحلة -->
        <div class="mode">
          <label class="chip"><input type="radio" name="tripmode" value="return" checked> ذهاب وعودة</label>
          <label class="chip"><input type="radio" name="tripmode" value="oneway"> ذهاب فقط</label>
          <label class="chip"><input type="radio" name="tripmode" value="multicity"> وجهات متعددة</label>
        </div>

        <!-- من -->
        <div class="fld">
          <div class="lbl">من</div>
          <input id="origin" list="airportsList" type="text" placeholder="مثال: BAH أو Bahrain — Manama (BAH)">
          <div class="hint">يمكنك كتابة كود IATA من 3 أحرف (مثل BAH) أو اختيار اقتراح من القائمة.</div>
        </div>

        <!-- إلى -->
        <div class="fld">
          <div class="lbl">إلى</div>
          <input id="destination" list="airportsList" type="text" placeholder="مثال: CAI أو Egypt — Cairo (CAI)">
          <div class="hint">لو لم تجد المطار في القائمة، اكتب كوده مباشرة (CAI / MHD / IKA …).</div>
        </div>

        <!-- التواريخ -->
        <div class="row2">
          <div class="fld">
            <div class="lbl">تاريخ الذهاب</div>
            <input id="dep" type="date">
          </div>
          <div class="fld">
            <div class="lbl">تاريخ العودة</div>
            <input id="ret" type="date">
          </div>
        </div>

        <!-- الركاب والدرجة -->
        <div class="fld">
          <div class="lbl">عدد المسافرين</div>
          <input id="pax" type="number" min="1" value="1">
        </div>
        <div class="fld">
          <div class="lbl">الدرجة</div>
          <select id="cabin">
            <option value="economy" selected>اقتصادية</option>
            <option value="business">أعمال</option>
            <option value="first">أولى</option>
          </select>
        </div>

        <!-- الموقع -->
        <div class="fld">
          <div class="lbl">الموقع</div>
          <select id="provider">
            <option value="skyscanner" selected>Skyscanner</option>
            <option value="kayak">KAYAK</option>
          </select>
        </div>

        <button class="cta" type="submit">ابحث 🔎</button>
      </form>
    </div>
  </header>

  <footer>
    <div class="disclaimer">
      <strong>تنويه:</strong> نحن لا نبيع التذاكر ولا نعمل كوسيط. هذه الخدمة أداة بحث فقط
      تقوم بإحالتك مباشرةً إلى مواقع الحجز المعروفة لإتمام عملية الحجز بنفسك. الأسعار والتوافر يخضعان لشروط
      تلك المواقع.
    </div>

    <!-- أيقونات شبكات التواصل -->
    <div class="social">
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://fadhel-alrayes.fun/index13.html" target="_blank">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" alt="Facebook">
      </a>
      <a href="https://twitter.com/intent/tweet?url=https://fadhel-alrayes.fun/index13.html&text=شاهد%20تذكرتك" target="_blank">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg" alt="X">
      </a>
      <a href="https://api.whatsapp.com/send?text=جرب%20موقع%20تذكرتك%20%20https://fadhel-alrayes.fun/index13.html" target="_blank">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp">
      </a>
      <a href="https://t.me/share/url?url=https://fadhel-alrayes.fun/index13.html&text=تذكرتك%20ابحث%20عن%20أرخص%20تذاكر%20الطيران" target="_blank">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/telegram.svg" alt="Telegram">
      </a>
    </div>

    <p class="credit">
      برمجة وتطوير:
      <a href="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0&wame_ctl=1"
         target="_blank" rel="noopener">فاضل الريس</a>
    </p>
  </footer>

  <!-- قائمة اقتراحات (يمكنك الكتابة الحرّ حتى إن لم يكن المطار هنا) -->
  <datalist id="airportsList"></datalist>

  <script>
    /************ 1) قاعدة بيانات كبيرة (العرب + العراق + إيران + مختارات دولية) ************/
    const ARAB_AIRPORTS = [
      // البحرين
      {country:'البحرين', city:'المنامة', code:'BAH'},

      // السعودية
      {country:'السعودية', city:'الرياض', code:'RUH'},
      {country:'السعودية', city:'جدة', code:'JED'},
      {country:'السعودية', city:'الدمام', code:'DMM'},
      {country:'السعودية', city:'المدينة', code:'MED'},
      {country:'السعودية', city:'أبها', code:'AHB'},
      {country:'السعودية', city:'القصيم', code:'ELQ'},
      {country:'السعودية', city:'جازان', code:'GIZ'},
      {country:'السعودية', city:'حائل', code:'HAS'},
      {country:'السعودية', city:'تبوك', code:'TUU'},
      {country:'السعودية', city:'العلا', code:'ULH'},
      {country:'السعودية', city:'ينبع', code:'YNB'},
      {country:'السعودية', city:'الطائف', code:'TIF'},
      {country:'السعودية', city:'نجران', code:'EAM'},

      // الإمارات
      {country:'الإمارات', city:'دبي', code:'DXB'},
      {country:'الإمارات', city:'أبوظبي', code:'AUH'},
      {country:'الإمارات', city:'الشارقة', code:'SHJ'},
      {country:'الإمارات', city:'رأس الخيمة', code:'RKT'},
      {country:'الإمارات', city:'العين', code:'AAN'},

      // قطر
      {country:'قطر', city:'الدوحة', code:'DOH'},

      // الكويت
      {country:'الكويت', city:'الكويت', code:'KWI'},

      // عُمان
      {country:'عُمان', city:'مسقط', code:'MCT'},
      {country:'عُمان', city:'صلالة', code:'SLL'},
      {country:'عُمان', city:'صحار', code:'OHS'},

      // اليمن
      {country:'اليمن', city:'صنعاء', code:'SAH'},
      {country:'اليمن', city:'عدن', code:'ADE'},
      {country:'اليمن', city:'سيئون', code:'GXF'},

      // سوريا
      {country:'سوريا', city:'دمشق', code:'DAM'},
      {country:'سوريا', city:'حلب', code:'ALP'},
      {country:'سوريا', city:'اللاذقية', code:'LTK'},

      // الأردن
      {country:'الأردن', city:'عمّان', code:'AMM'},
      {country:'الأردن', city:'العقبة', code:'AQJ'},

      // لبنان
      {country:'لبنان', city:'بيروت', code:'BEY'},

      // مصر
      {country:'مصر', city:'القاهرة', code:'CAI'},
      {country:'مصر', city:'الإسكندرية/برج العرب', code:'HBE'},
      {country:'مصر', city:'الغردقة', code:'HRG'},
      {country:'مصر', city:'شرم الشيخ', code:'SSH'},
      {country:'مصر', city:'الأقصر', code:'LXR'},
      {country:'مصر', city:'أسوان', code:'ASW'},
      {country:'مصر', city:'مرسى علم', code:'RMF'},
      {country:'مصر', city:'سوهاج', code:'HMB'},
      {country:'مصر', city:'أسيوط', code:'ATZ'},

      // السودان
      {country:'السودان', city:'الخرطوم', code:'KRT'},
      {country:'السودان', city:'بورتسودان', code:'PZU'},

      // ليبيا
      {country:'ليبيا', city:'طرابلس معيتيقة', code:'MJI'},
      {country:'ليبيا', city:'بنغازي', code:'BEN'},
      {country:'ليبيا', city:'مصراتة', code:'MRA'},

      // تونس
      {country:'تونس', city:'تونس قرطاج', code:'TUN'},
      {country:'تونس', city:'صفاقس', code:'SFA'},
      {country:'تونس', city:'جربة/جرجيس', code:'DJE'},
      {country:'تونس', city:'المنستير/الحبيب بورقيبة', code:'MIR'},
      {country:'تونس', city:'النفيضة الحمامات', code:'NBE'},

      // الجزائر
      {country:'الجزائر', city:'الجزائر', code:'ALG'},
      {country:'الجزائر', city:'وهران', code:'ORN'},
      {country:'الجزائر', city:'قسنطينة', code:'CZL'},
      {country:'الجزائر', city:'غرداية', code:'GHA'},

      // المغرب
      {country:'المغرب', city:'الدار البيضاء', code:'CMN'},
      {country:'المغرب', city:'الرباط', code:'RBA'},
      {country:'المغرب', city:'مراكش', code:'RAK'},
      {country:'المغرب', city:'طنجة', code:'TNG'},
      {country:'المغرب', city:'أكادير', code:'AGA'},
      {country:'المغرب', city:'فاس', code:'FEZ'},
      {country:'المغرب', city:'وجدة', code:'OUD'},

      // موريتانيا
      {country:'موريتانيا', city:'نواكشوط', code:'NKC'},

      // جيبوتي
      {country:'جيبوتي', city:'جيبوتي', code:'JIB'},

      // الصومال
      {country:'الصومال', city:'مقديشو', code:'MGQ'},
      {country:'الصومال', city:'هرجيسا', code:'HGA'},

      // جزر القمر
      {country:'جزر القمر', city:'موروني', code:'HAH'},
    ];

    const IRAQ_AIRPORTS = [
      {country:'العراق', city:'بغداد', code:'BGW'},
      {country:'العراق', city:'أربيل', code:'EBL'},
      {country:'العراق', city:'السليمانية', code:'ISU'},
      {country:'العراق', city:'البصرة', code:'BSR'},
      {country:'العراق', city:'النجف', code:'NJF'},
      {country:'العراق', city:'الموصل', code:'OSM'},
      {country:'العراق', city:'كربلاء (أقرب: النجف)', code:'NJF'},
      {country:'العراق', city:'ذي قار/الناصرية', code:'XNH'} /* قد يظهر كرمز تشغيلي */
    ];

    const IRAN_AIRPORTS = [
      {country:'إيران', city:'طهران الإمام الخميني', code:'IKA'},
      {country:'إيران', city:'طهران مهرآباد', code:'THR'},
      {country:'إيران', city:'مشهد', code:'MHD'},
      {country:'إيران', city:'شيراز', code:'SYZ'},
      {country:'إيران', city:'تبريز', code:'TBZ'},
      {country:'إيران', city:'أصفهان', code:'IFN'},
      {country:'إيران', city:'كِش', code:'KIH'},
      {country:'إيران', city:'بندر عباس', code:'BND'},
      {country:'إيران', city:'كرمنشاه', code:'KSH'},
      {country:'إيران', city:'أهواز', code:'AWZ'},
      {country:'إيران', city:'يزد', code:'AZD'},
      {country:'إيران', city:'كرمان', code:'KER'},
      {country:'إيران', city:'زاهدان', code:'ZAH'},
      {country:'إيران', city:'رشت', code:'RAS'},
      {country:'إيران', city:'ساري', code:'SRY'},
      {country:'إيران', city:'رامسر', code:'RZR'},
      {country:'إيران', city:'بوشهر', code:'BUZ'},
      {country:'إيران', city:'قشم', code:'GSM'},
      {country:'إيران', city:'أُرومية', code:'OMH'},
      {country:'إيران', city:'سنندج', code:'SDG'},
      {country:'إيران', city:'ماهشهر', code:'MRX'},
      {country:'إيران', city:'نوشهر', code:'NSH'},
      {country:'إيران', city:'جرجان', code:'GBT'},
      {country:'إيران', city:'لار', code:'LRR'},
      {country:'إيران', city:'إيلام', code:'IIL'}
    ];

    const INTL_AIRPORTS = [
      {country:'تركيا', city:'إسطنبول الجديدة', code:'IST'},
      {country:'تركيا', city:'صبيحة كوكجن', code:'SAW'},
      {country:'تركيا', city:'أنطاليا', code:'AYT'},
      {country:'تركيا', city:'طرابزون', code:'TZX'},
      {country:'فرنسا', city:'باريس شارل ديغول', code:'CDG'},
      {country:'المملكة المتحدة', city:'لندن هيثرو', code:'LHR'},
      {country:'ألمانيا', city:'فرانكفورت', code:'FRA'},
      {country:'هولندا', city:'أمستردام', code:'AMS'},
      {country:'سويسرا', city:'زيورخ', code:'ZRH'},
      {country:'إيطاليا', city:'روما فيوميتشينو', code:'FCO'},
      {country:'إسبانيا', city:'برشلونة', code:'BCN'}
    ];

    const ALL_AIRPORTS = [...ARAB_AIRPORTS, ...IRAQ_AIRPORTS, ...IRAN_AIRPORTS, ...INTL_AIRPORTS];

    /************ 2) تعبئة datalist بالاقتراحات ************/
    function buildDatalist(){
      const dl = document.getElementById('airportsList');
      dl.innerHTML = '';
      const byCountry = {};
      ALL_AIRPORTS.forEach(a => (byCountry[a.country] ||= []).push(a));
      Object.keys(byCountry).sort((a,b)=>a.localeCompare(b,'ar')).forEach(country=>{
        byCountry[country].sort((a,b)=>a.city.localeCompare(b.city,'ar')).forEach(a=>{
          const opt = document.createElement('option');
          opt.value = `${country} — ${a.city} (${a.code})`;
          dl.appendChild(opt);
        });
      });
    }

    /************ 3) استخراج كود IATA من إدخال المستخدم ************/
    function extractIATA(text){
      if(!text) return '';
      // 1) إن كان النص ينتهي بـ (XXX)
      const m = text.match(/\(([A-Za-z0-9]{3})\)\s*$/);
      if(m) return m[1].toUpperCase();
      // 2) إن كتب المستخدم 3 أحرف فقط
      const t = text.trim().toUpperCase();
      if(/^[A-Z0-9]{3}$/.test(t)) return t;
      // 3) محاولة مطابقة اسم مدينة/دولة من قائمتنا
      const hit = ALL_AIRPORTS.find(a => {
        const label = `${a.country} — ${a.city} (${a.code})`.toLowerCase();
        return label.includes(text.trim().toLowerCase());
      });
      if(hit) return hit.code.toUpperCase();
      // 4) فشل — نعيد فارغ
      return '';
    }

    /************ 4) بناء الروابط ************/
    const kayakCabin = c => ({economy:'e',business:'b',first:'f'}[c]||'e');
    const ymd = d => d || "";
    const ymdCompact = d => d ? d.replace(/-/g,'') : "";

    function buildURL(provider, mode, oCode, dCode, dep, ret, pax, cabin){
      const depYMD = ymd(dep), retYMD = ymd(ret);
      const depSC  = ymdCompact(dep), retSC = ymdCompact(ret);

      if(mode === 'multicity'){
        if(provider==='skyscanner'){
          return 'https://www.skyscanner.net/transport/flights/multi-city/?locale=ar-SA';
        }else{
          return 'https://www.kayak.ae/flights/multi-stop?lang=ar';
        }
      }

      switch(provider){
        case 'skyscanner': {
          let base = `https://www.skyscanner.net/transport/flights/${oCode}/${dCode}`;
          if(depSC) base += `/${depSC}`;
          if(mode==='return' && retSC) base += `/${retSC}`;
          return `${base}/?adults=${encodeURIComponent(pax)}&cabinclass=${encodeURIComponent(cabin)}&locale=ar-SA`;
        }
        case 'kayak': {
          let base = `https://www.kayak.ae/flights/${oCode}-${dCode}`;
          if(depYMD) base += `/${depYMD}`;
          if(mode==='return' && retYMD) base += `/${retYMD}`;
          return `${base}?adults=${encodeURIComponent(pax)}&cabin=${encodeURIComponent(kayakCabin(cabin))}&lang=ar&sort=price_a`;
        }
        default: return '#';
      }
    }

    function openSelected(){
      const mode = document.querySelector('input[name="tripmode"]:checked').value;
      const originText = document.getElementById('origin').value;
      const destText   = document.getElementById('destination').value;
      const oCode = extractIATA(originText);
      const dCode = extractIATA(destText);

      if(!oCode || !dCode){
        alert('الرجاء إدخال كود IATA من 3 أحرف (مثال: BAH, CAI, MHD, IKA) أو اختيار عنصر من الاقتراحات.');
        return;
      }

      const p = document.getElementById('provider').value;
      const dep = document.getElementById('dep').value;
      const ret = document.getElementById('ret').value;
      const pax = document.getElementById('pax').value || 1;
      const cabin = document.getElementById('cabin').value;

      if(mode!=='multicity' && !dep){
        alert('من الأفضل تحديد تاريخ الذهاب.');
        return;
      }

      const url = buildURL(p, mode, oCode, dCode, dep, ret, pax, cabin);
      window.open(url, '_blank', 'noopener');
    }

    /************ 5) تهيئة الصفحة (تواريخ افتراضية: اليوم + الغد) ************/
    (function init(){
      buildDatalist();

      const now = new Date();
      const tomorrow = new Date(now); tomorrow.setDate(now.getDate()+1);
      const iso = d => d.toISOString().slice(0,10);
      document.getElementById('dep').value = iso(now);
      document.getElementById('ret').value = iso(tomorrow);

      // قيم افتراضية للمدخلات
      document.getElementById('origin').value = 'البحرين — المنامة (BAH)';
      document.getElementById('destination').value = 'مصر — القاهرة (CAI)';
      document.getElementById('pax').value = 1;
      document.getElementById('cabin').value = 'economy';
      document.getElementById('provider').value = 'skyscanner';
    })();
  </script>
</body>
</html>
