<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Ù„ØªØ± Ù‡Ø¯ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† | Letterhead A4 Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ</title>
<meta name="description" content="Ø¥Ù†Ø´Ø§Ø¡ Ù„ØªØ± Ù‡Ø¯ Ø¹Ø±Ø¨ÙŠ A4 Ù…Ø¹ Ø®ØªÙ… Ø£Ø²Ø±Ù‚ Ø±Ø³Ù…ÙŠ ÙˆØªÙˆÙ‚ÙŠØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ´Ø¨ÙƒØ§Øª ØªÙˆØ§ØµÙ„ØŒ Ø«Ù… ØªØ­Ù…ÙŠÙ„ PDF Ø£Ùˆ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©.">
<meta name="robots" content="index,follow">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">

<style>
:root{--gold:#C6A14A;--black:#0b0f19;--ink:#111827;--muted:#6b7280;--paper:#fff;--stamp:#0a4ea6}
*{box-sizing:border-box;-webkit-print-color-adjust:exact;print-color-adjust:exact}
html,body{height:100%}
body{margin:0;background:#f6f7f9;color:var(--ink);font-family:"Cairo",system-ui}

/* ØªØ®Ø·ÙŠØ· */
.wrap{max-width:1200px;margin:auto;padding:12px;display:grid;gap:12px;grid-template-columns:clamp(320px,46vw,520px) 1fr}
@media(max-width:1024px){.wrap{grid-template-columns:1fr}}
.card{background:#fff;border:1px solid #e7e9ef;border-radius:14px;box-shadow:0 8px 16px rgba(0,0,0,.05);overflow:hidden}
.hd{padding:14px;background:linear-gradient(90deg,var(--black),#1b2335);color:#fff;font-weight:800;text-align:center}
.bd{padding:14px}
label{display:block;font:700 13px/1 "Cairo";color:var(--muted);margin:8px 2px 6px}
input,select,textarea{width:100%;padding:12px;border:1px solid #dfe3ea;border-radius:12px;font-size:15px;background:#fff}
textarea{min-height:120px;resize:vertical}
.grid{display:grid;gap:10px}
.g2{grid-template-columns:1fr 1fr}.g4{grid-template-columns:repeat(4,1fr)}
@media(max-width:720px){.g2,.g4{grid-template-columns:1fr}}
.btns{display:grid;gap:8px;grid-template-columns:1fr 1fr}
.btn{border:0;border-radius:12px;padding:12px 14px;font-weight:800;font-size:15px;cursor:pointer}
.btn.primary{background:var(--gold);color:#000}.btn.ghost{background:#eef2f7}

/* ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø© */
.settings .bd{max-width:520px;margin:0 auto}
.note{margin:8px 0 14px;padding:14px 16px;background:#fff;border:1px solid rgba(198,161,74,.35);border-radius:14px;box-shadow:0 10px 22px rgba(198,161,74,.08)}
.note h3{margin:0 0 8px;font:800 16px/1.2 "Cairo";color:var(--black)}
.note p{margin:0;color:#222;line-height:1.9;text-align:justify;text-justify:inter-word}
.note p,strong{font-size:14.5px}
.note p strong{font-weight:700}

/* Ø£Ø¯ÙˆØ§Øª */
.tools{display:flex;gap:10px;align-items:center;padding:10px 10px 0}
.tool{display:inline-flex;align-items:center;gap:8px;height:42px;padding:0 14px;border-radius:12px;border:1px solid #e4e7ef;background:#fff;cursor:pointer;font-weight:800;font-size:13.5px;white-space:nowrap}
.tool.dark{background:linear-gradient(180deg,#1b2335,#0b0f19);color:#fff;border:0}
.tool svg{width:16px;height:16px}

/* Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
.preview{padding:8px 10px 0}
.viewport{width:100%;display:flex;justify-content:center;align-items:flex-start;overflow:hidden}
.scale-box{transform-origin:top center;display:inline-block}

/* ØµÙØ­Ø© A4 */
#page{width:210mm;height:297mm;background:var(--paper);position:relative;overflow:hidden;border:1px solid #e6e7ec;border-radius:14px;box-shadow:0 10px 26px rgba(0,0,0,.06)}
.lh{background:linear-gradient(90deg,var(--black),#121828);color:#fff;padding:12px 18px;display:flex;align-items:center;gap:10px}
.logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--gold),#ffe9a6);display:grid;place-items:center;color:#000;font-weight:900}
.brand-name{font-weight:800;font-size:19px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:70%}
.gold-line{height:5px;background:linear-gradient(90deg,#ead89c,var(--gold),#a6842a)}

/* Ø¬Ø³Ù… Ø§Ù„Ø®Ø·Ø§Ø¨ */
.doc{padding:12mm 18mm 64mm;height:calc(297mm - 53px - 5px - 64mm);overflow:auto}
.meta{font-size:12px;color:var(--muted);display:flex;justify-content:space-between;border-bottom:1px dashed #e5e7eb;padding-bottom:6px}
.title{text-align:center;font-size:24px;font-weight:800;margin:12px 0 8px}
.content{font-size:15px;line-height:1.9;text-align:justify;text-justify:inter-word}

/* ØªØ°ÙŠÙŠÙ„ Ø¯Ø§Ø®Ù„ A4 */
.ft{position:absolute;left:0;right:0;bottom:0;height:64mm;padding:10mm 18mm 14mm;display:flex;align-items:flex-end;justify-content:space-between}
.bar{position:absolute;left:0;right:0;bottom:0;height:42px;background:linear-gradient(90deg,var(--black),#121828);display:flex;align-items:center}
.bar .social{display:flex;gap:16px;align-items:center;color:#fff;padding:0 18mm}
.bar .social .item{display:flex;align-items:center;gap:6px;direction:ltr;white-space:nowrap}
.bar .social .item span{color:#f6f6f6}
/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ØªÙˆØ§ØµÙ„ Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø°Ù‡Ø¨ÙŠØ© */
.bar .social svg{width:15px;height:15px;fill:#C6A14A}

/* Ø®ØªÙ… */
.left-col{display:flex;flex-direction:column;gap:8px;align-items:flex-start}
.stamp-box{width:60mm;min-height:33mm;padding:10px 12px;border-radius:12px;position:relative;border:2px solid var(--stamp);background:#fff}
.sig-overlay{position:absolute;left:10px;right:10px;top:8px;height:60px;display:flex;align-items:center}
.sig-overlay img{max-height:60px;filter:grayscale(1) contrast(1.1)}
.stamp-ink,.stamp-line{color:var(--stamp);font-weight:800}
.stamp-line{direction:ltr;text-align:left}
.person{text-align:left;direction:ltr;margin-top:2px}.person strong{font-size:14.5px}

/* Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ */
.sig-pad{background:#fff;border:1px dashed #cbd5e1;border-radius:12px;padding:10px}
#sigCanvas{width:100%;height:180px;background:#fff;border:1px solid #e5e7eb;border-radius:10px;touch-action:none}

/* Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø© â€” Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙ‚Ø· ÙˆÙÙŠ Ø§Ù„ÙˆØ³Ø· */
.share-site{max-width:1200px;margin:6px auto 8px;padding:6px 12px;text-align:center}
.share-box{border:1px solid #e7e9ef;background:#fff;border-radius:14px;box-shadow:0 8px 16px rgba(0,0,0,.05);padding:12px}
.share-title{font:800 15px/1 "Cairo";margin:0 0 10px;color:var(--black)}
.icon-row{display:flex;justify-content:center;gap:16px}
.icon-row a{display:inline-grid;place-items:center;width:42px;height:42px;border-radius:50%;text-decoration:none;transition:.18s transform}
/* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø°Ù‡Ø¨ÙŠØ© */
.icon-row a svg{width:22px;height:22px;fill:#C6A14A}
.icon-row a:hover{transform:translateY(-2px)}

/* Ù…ÙˆØ¯Ø§Ù„ Ø±Ø³Ø§Ø¦Ù„ */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:9999}
.modal.show{display:flex}
.modal .box{width:min(92vw,520px);background:#fff;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.25);overflow:hidden}
.modal .box .hd{background:linear-gradient(90deg,var(--black),#1b2335);color:#fff;text-align:center;padding:12px 16px}
.modal .box .bd{padding:16px;font-size:15px}
.modal .box .ft{padding:12px;display:flex;justify-content:center;background:#f6f7f9}
.modal .box .ft button{border:0;background:var(--gold);color:#000;border-radius:10px;font-weight:800;padding:9px 16px;cursor:pointer}

/* ÙÙˆØªØ± */
.site-footer{max-width:1200px;margin:4px auto 12px;color:#6b7280;text-align:center;padding:0 10px}
.site-footer a{color:var(--gold);text-decoration:none;font-weight:800}
.site-footer a:hover{text-decoration:underline}

@page{size:A4;margin:0}
@media print{body *{visibility:hidden}#page,#page *{visibility:visible}#page{position:absolute;inset:0;transform:none;box-shadow:none}}
</style>
</head>
<body>

<main class="wrap">
  <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
  <section class="card settings" aria-label="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØªØ± Ù‡Ø¯">
    <div class="hd">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØªØ± Ù‡Ø¯</div>
    <div class="bd">
      <!-- Ø§Ù„ÙˆØµÙ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ -->
      <div class="note">
        <h3>ÙˆØµÙ Ø§Ù„Ø®Ø¯Ù…Ø©</h3>
        <p>
          Ø¥Ù†Ø´Ø§Ø¡ Ù„ØªØ± Ù‡Ø¯ /Letterhead Ø¨Ø­Ø¬Ù… A4: Ø´Ø¹Ø§Ø± Ø¹Ù„ÙˆÙŠØŒ Ø¹Ù†ÙˆØ§Ù† ÙˆÙ…Ø­ØªÙˆÙ‰ØŒ
          <strong>Ø®ØªÙ… Ø£Ø²Ø±Ù‚ Ø±Ø³Ù…ÙŠ</strong>ØŒ ØªÙˆÙ‚ÙŠØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ØŒ
          Ø«Ù… <strong>ØªØ­Ù…ÙŠÙ„ PDF</strong> Ø£Ùˆ <strong>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„Ù</strong> Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø£ÙŠ ØªØ·Ø¨ÙŠÙ‚.
        </p>
      </div>

      <div class="grid">
        <div><label>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</label><input id="company" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø´Ø±ÙƒØ© Ø§Ù„Ø£ÙÙ‚ Ù„Ù„ØªØ¬Ø§Ø±Ø©"></div>

        <div class="g2">
          <div><label>ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
            <select id="countryCode">
              <option value="+213">ğŸ‡©ğŸ‡¿ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± (+213)</option>
              <option value="+973" selected>ğŸ‡§ğŸ‡­ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† (+973)</option>
              <option value="+269">ğŸ‡°ğŸ‡² Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø± (+269)</option>
              <option value="+253">ğŸ‡©ğŸ‡¯ Ø¬ÙŠØ¨ÙˆØªÙŠ (+253)</option>
              <option value="+20">ğŸ‡ªğŸ‡¬ Ù…ØµØ± (+20)</option>
              <option value="+964">ğŸ‡®ğŸ‡¶ Ø§Ù„Ø¹Ø±Ø§Ù‚ (+964)</option>
              <option value="+962">ğŸ‡¯ğŸ‡´ Ø§Ù„Ø£Ø±Ø¯Ù† (+962)</option>
              <option value="+965">ğŸ‡°ğŸ‡¼ Ø§Ù„ÙƒÙˆÙŠØª (+965)</option>
              <option value="+961">ğŸ‡±ğŸ‡§ Ù„Ø¨Ù†Ø§Ù† (+961)</option>
              <option value="+218">ğŸ‡±ğŸ‡¾ Ù„ÙŠØ¨ÙŠØ§ (+218)</option>
              <option value="+222">ğŸ‡²ğŸ‡· Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§ (+222)</option>
              <option value="+212">ğŸ‡²ğŸ‡¦ Ø§Ù„Ù…ØºØ±Ø¨ (+212)</option>
              <option value="+968">ğŸ‡´ğŸ‡² Ø¹ÙÙ…Ø§Ù† (+968)</option>
              <option value="+970">ğŸ‡µğŸ‡¸ ÙÙ„Ø³Ø·ÙŠÙ† (+970)</option>
              <option value="+974">ğŸ‡¶ğŸ‡¦ Ù‚Ø·Ø± (+974)</option>
              <option value="+966">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© (+966)</option>
              <option value="+252">ğŸ‡¸ğŸ‡´ Ø§Ù„ØµÙˆÙ…Ø§Ù„ (+252)</option>
              <option value="+249">ğŸ‡¸ğŸ‡© Ø§Ù„Ø³ÙˆØ¯Ø§Ù† (+249)</option>
              <option value="+963">ğŸ‡¸ğŸ‡¾ Ø³ÙˆØ±ÙŠØ§ (+963)</option>
              <option value="+216">ğŸ‡¹ğŸ‡³ ØªÙˆÙ†Ø³ (+216)</option>
              <option value="+971">ğŸ‡¦ğŸ‡ª Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª (+971)</option>
              <option value="+967">ğŸ‡¾ğŸ‡ª Ø§Ù„ÙŠÙ…Ù† (+967)</option>
            </select>
          </div>
          <div><label>Ø±Ù‚Ù… Ø§Ù„Ø§ØªØµØ§Ù„</label><input id="phone" type="tel" placeholder="3333 3333"></div>
        </div>

        <div><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input id="email" type="email" placeholder="name@example.com"></div>
        <div><label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©</label><input id="titleIn" type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©"></div>
        <div><label>Ø§Ù„Ù…Ø­ØªÙˆÙ‰</label><textarea id="contentIn" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§..."></textarea></div>

        <div class="g2">
          <div><label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠ (Ù„Ù„ØªÙˆÙ‚ÙŠØ¹)</label><input id="personNameIn" type="text"></div>
          <div><label>Ø§Ù„ØµÙØ© / Ø§Ù„ÙˆØ¸ÙŠÙØ©</label><input id="personRoleIn" type="text"></div>
        </div>

        <div class="g2">
          <div><label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input id="addressIn" type="text" placeholder="Ø§Ù„Ù…Ù†Ø§Ù…Ø© - Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†"></div>
          <div><label>Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ (CR)</label><input id="cr" type="text" placeholder="555432"></div>
        </div>

        <div class="g4">
          <div><label>Instagram</label><input id="igIn" type="text" placeholder="@brand"></div>
          <div><label>Twitter / X</label><input id="twIn" type="text" placeholder="@brand"></div>
          <div><label>Facebook</label><input id="fbIn" type="text" placeholder="/brand"></div>
          <div><label>LinkedIn</label><input id="lnIn" type="text" placeholder="/company"></div>
        </div>

        <!-- ØªÙˆÙ‚ÙŠØ¹ -->
        <div>
          <label>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</label>
          <div class="sig-pad">
            <canvas id="sigCanvas"></canvas>
            <div class="btns" style="margin-top:8px">
              <button type="button" class="btn ghost" id="clearSig">Ù…Ø³Ø­ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</button>
              <button type="button" class="btn primary" id="useSig">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
  <section class="card" aria-label="Ù…Ø¹Ø§ÙŠÙ†Ø© A4">
    <div class="hd">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</div>

    <div class="tools" role="toolbar" aria-label="Ø£Ø¯ÙˆØ§Øª">
      <button class="tool" id="printView" title="Ø·Ø¨Ø§Ø¹Ø©">
        <svg viewBox="0 0 24 24"><path d="M6 2h12v6H6zM6 14h12v8H6z"/></svg><span>Ø·Ø¨Ø§Ø¹Ø©</span>
      </button>
      <button class="tool dark" id="downloadPdf" title="ØªØ­Ù…ÙŠÙ„ PDF">
        <svg viewBox="0 0 24 24"><path d="M12 3v10.59l3.3-3.3 1.4 1.42L12 17.41 7.3 11.7l1.4-1.41 3.3 3.3V3h2z"/></svg><span>ØªØ­Ù…ÙŠÙ„ PDF</span>
      </button>
      <button class="tool" id="sharePdf" title="Ù…Ø´Ø§Ø±ÙƒØ©">
        <svg viewBox="0 0 24 24"><path d="M16 8a3 3 0 1 0-2.8-4H13v8.3l-2.1-1.2-1 1.7 4 2.3V22h2V8zM6 9h3v2H8v9H6z"/></svg><span>Ù…Ø´Ø§Ø±ÙƒØ©</span>
      </button>
    </div>

    <div class="bd preview">
      <div class="viewport" id="viewport">
        <div class="scale-box" id="scaleBox">
          <div id="page" aria-label="ÙˆØ±Ù‚Ø© A4">
            <header class="lh"><div class="logo" aria-hidden="true">â˜…</div><div class="brand-name" id="brandName">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</div></header>
            <div class="gold-line"></div>

            <main class="doc">
              <div class="meta">
                <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="today"></span></div>
                <div>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: <span id="addressOut">â€”</span></div>
              </div>
              <h1 class="title" id="titleOut">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©</h1>
              <article class="content" id="contentOut">Ø³ÙŠØ¸Ù‡Ø± Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù‡Ù†Ø§ Ø¨Ù…Ø­Ø§Ø°Ø§Ø© Ø§Ù„Ø£Ø·Ø±Ø§Ù.</article>
            </main>

            <footer class="ft">
              <div class="bar"><div class="social" id="socialRow"></div></div>
              <div class="left-col">
                <div class="stamp-box" aria-label="Ø§Ù„Ø®ØªÙ…">
                  <div class="sig-overlay" id="sigInStamp"></div>
                  <div class="stamp-ink" id="stampCompany">Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©</div>
                  <div class="stamp-line" id="crOut">CR: â€”</div>
                  <div class="stamp-line" id="phoneOut">Tel: â€”</div>
                </div>
                <div class="person"><strong id="personName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠ</strong> â€” <span id="personRole">Ø§Ù„ØµÙØ© / Ø§Ù„ÙˆØ¸ÙŠÙØ©</span></div>
              </div>
              <div class="identity"></div>
            </footer>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<!-- Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø©: Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙ‚Ø· ÙˆÙÙŠ Ø§Ù„ÙˆØ³Ø· -->
<section class="share-site" aria-label="Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø©">
  <div class="share-box">
    <h3 class="share-title">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø©</h3>
    <div class="icon-row" id="shareRow"></div>
  </div>
</section>

<footer class="site-footer">
  Ø¨Ø±Ù…Ø¬Ø© ÙˆØªØ·ÙˆÙŠØ± :
  <a href="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0" target="_blank" rel="noopener">ÙØ§Ø¶Ù„ Ø§Ù„Ø±ÙŠØ³</a>
</footer>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
<div class="modal" id="msgModal">
  <div class="box" role="dialog" aria-live="polite">
    <div class="hd" id="msgTitle">ØªÙ†ÙˆÙŠÙ‡</div>
    <div class="bd" id="msgBody">Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.</div>
    <div class="ft"><button type="button" id="msgOk">Ø­Ø³Ù†Ù‹Ø§</button></div>
  </div>
</div>

<!-- Ù…ÙƒØªØ¨Ø§Øª -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
<script>
const DM={'Ù ':'0','Ù¡':'1','Ù¢':'2','Ù£':'3','Ù¤':'4','Ù¥':'5','Ù¦':'6','Ù§':'7','Ù¨':'8','Ù©':'9','Û°':'0','Û±':'1','Û²':'2','Û³':'3','Û´':'4','Ûµ':'5','Û¶':'6','Û·':'7','Û¸':'8','Û¹':'9'};
const $=id=>document.getElementById(id);

/* Ø§Ù„ØªØ§Ø±ÙŠØ® */
$("today").textContent=new Date().toLocaleDateString("en-GB");

/* Ù…ÙˆØ¯Ø§Ù„ */
const modal=$("msgModal");$("msgOk").onclick=()=>modal.classList.remove("show");
function showMsg(t,b){$("msgTitle").textContent=t;$("msgBody").innerHTML=b;modal.classList.add("show")}

/* Ø­ÙØ¸/ØªØ­Ù…ÙŠÙ„ */
const STORE='letterheadFormV13';
function saveState(extra={}){const ids=['company','countryCode','phone','email','titleIn','contentIn','personNameIn','personRoleIn','addressIn','cr','igIn','twIn','fbIn','lnIn','signatureDataURL'];const d={};ids.forEach(id=>{const el=$(id);if(el)d[id]=el.value??''});Object.assign(d,extra);localStorage.setItem(STORE,JSON.stringify(d))}
function loadState(){try{const raw=localStorage.getItem(STORE);if(!raw)return{};const d=JSON.parse(raw);for(const [k,v] of Object.entries(d)){const el=$(k);if(el)el.value=v}if(d.signatureDataURL){const img=new Image();img.src=d.signatureDataURL;img.alt='Ø§Ù„ØªÙˆÙ‚ÙŠØ¹';$("sigInStamp").innerHTML='';$("sigInStamp").appendChild(img)}return d}catch(e){return{}}}

/* Ø¹Ù†Ø§ØµØ± */
const company=$("company"), country=$("countryCode"), phone=$("phone"), email=$("email"),
      titleIn=$("titleIn"), contentIn=$("contentIn"), personNameIn=$("personNameIn"), personRoleIn=$("personRoleIn"),
      addressIn=$("addressIn"), cr=$("cr"), igIn=$("igIn"), twIn=$("twIn"), fbIn=$("fbIn"), lnIn=$("lnIn");

const brandName=$("brandName"), titleOut=$("titleOut"), contentOut=$("contentOut"), addressOut=$("addressOut"),
      stampCompany=$("stampCompany"), crOut=$("crOut"), phoneOut=$("phoneOut"),
      personName=$("personName"), personRole=$("personRole"), socialRow=$("socialRow");

/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ØªÙˆØ§ØµÙ„ Ø§Ù„ØªØ°ÙŠÙŠÙ„ (Ø°Ù‡Ø¨ÙŠØ©) */
const ICON=p=>`<svg viewBox="0 0 24 24"><g fill="#C6A14A">${p}</g></svg>`;
const icons={
  ig: ICON('<path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Zm5 5a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm6.5-.9a1.1 1.1 0 1 0 0 2.2 1.1 1.1 0 0 0 0-2.2Z"/><circle cx="12" cy="12" r="3.3"/>'),
  tw: ICON('<path d="M13.7 10.6 21 2h-1.7l-6.2 7.4L8.2 2H2l7.6 11L2 22h1.7l6.6-7.8L15.8 22H22l-8.3-11.4Z"/>'),
  fb: ICON('<path d="M22 12a10 10 0 1 0-11.6 9.9v-7H7.7V12h2.7V9.7c0-2.7 1.6-4.2 4-4.2 1.2 0 2.4.2 2.4.2v2.6h-1.4c-1.3 0-1.7.8-1.7 1.6V12h2.9l-.46 2.9h-2.4v7A10 10 0 0 0 22 12"/>'),
  ln: ICON('<path d="M4.98 3.5a2.5 2.5 0 1 1 0 5.001 2.5 2.5 0 0 1 0-5zM3 9h4v12H3zM9 9h3.8v1.6h.1c.5-.9 1.8-1.9 3.7-1.9 4 0 4.8 2.6 4.8 6v6H17v-5.3c0-1.3 0-3-1.9-3s-2.2 1.4-2.2 2.9V21H9z"/>'),
  mail: ICON('<path d="M3 6h18v12H3z"/><path fill="#0b0f19" d="M3 8.2 12 13l9-4.8V6H3v2.2z"/>'),
  phone: ICON('<path d="M6.6 2h2.7l1.1 4-2 1.2a13.5 13.5 0 0 0 6 6l1.2-2 4 1.1v2.7c0 1-0.8 1.9-1.8 1.9-7.8 0-14.1-6.3-14.1-14.1C4.7 2.8 5.6 2 6.6 2z"/>')
};
function fullPhone(){const p=(phone.value||'').replace(/[Ù -Ù©Û°-Û¹]/g,d=>DM[d]);return (country.value&&p)?`${country.value}\u00A0${p}`:(p||'')}
function buildSocial(){
  socialRow.innerHTML='';
  const items=[];
  if(igIn.value.trim()) items.push({icon:icons.ig,txt:igIn.value.trim()});
  if(twIn.value.trim()) items.push({icon:icons.tw,txt:twIn.value.trim()});
  if(fbIn.value.trim()) items.push({icon:icons.fb,txt:fbIn.value.trim()});
  if(lnIn.value.trim()) items.push({icon:icons.ln,txt:lnIn.value.trim()});
  if(email.value.trim()) items.push({icon:icons.mail,txt:email.value.trim()});
  const ph=fullPhone(); if(ph) items.push({icon:icons.phone,txt:ph});
  items.forEach(it=>{const d=document.createElement('div');d.className='item';d.innerHTML=it.icon+'<span>'+it.txt+'</span>';socialRow.appendChild(d)});
}

/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙØ­Ø© (Ø°Ù‡Ø¨ÙŠØ©) */
function buildShareBar(){
  const url=encodeURIComponent(location.href);
  const text=encodeURIComponent('Ø¬Ø±Ù‘Ø¨ Ø¥Ù†Ø´Ø§Ø¡ Ù„ØªØ± Ù‡Ø¯ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†');
  const row=$("shareRow"); row.innerHTML='';
  const items=[
    {label:'ÙˆØ§ØªØ³Ø§Ø¨',href:`https://wa.me/?text=${text}%20${url}`,path:"M16.6 14.4c-.2.6-1 1-1.6.7-1.8-.9-3.3-2.4-4.2-4.2-.3-.6.1-1.4.7-1.6l.8-.3c.3-.1.5 0 .7.3l.9 1.4c.2.3.1.6-.1.8l-.3.3c.6 1 1.5 1.8 2.5 2.5l.3-.3c.2-.2.5-.3.8-.1l1.4.9c.3.2.4.4.3.7l-.3.8ZM12 2a10 10 0 0 1 8.8 14.8L20 22l-5.2-.8A10 10 0 1 1 12 2Z"},
    {label:'ØªÙ„ØºØ±Ø§Ù…',href:`https://t.me/share/url?url=${url}&text=${text}`,path:"M21.5 3.5 2.9 10.8c-1 .4-1 1.8 0 2.2l4.6 1.7 1.8 5.6c.3 1 1.6 1.2 2.2.3l2.7-3.5 5.1 3.7c.8.6 2 .2 2.2-.8l2.7-15.6c.2-1-1-1.8-2.3-1.1Z"},
    {label:'X',href:`https://twitter.com/intent/tweet?url=${url}&text=${text}`,path:"M13.7 10.6 21 2h-1.7l-6.2 7.4L8.2 2H2l7.6 11L2 22h1.7l6.6-7.8L15.8 22H22l-8.3-11.4Z"},
    {label:'ÙÙŠØ³Ø¨ÙˆÙƒ',href:`https://www.facebook.com/sharer/sharer.php?u=${url}`,path:"M22 12a10 10 0 1 0-11.6 9.9v-7H7.7V12h2.7V9.7c0-2.7 1.6-4.2 4-4.2 1.2 0 2.4.2 2.4.2v2.6h-1.4c-1.3 0-1.7.8-1.7 1.6V12h2.9l-.46 2.9h-2.4v7A10 10 0 0 0 22 12"},
    {label:'Ù„ÙŠÙ†ÙƒØ¯Ø¥Ù†',href:`https://www.linkedin.com/sharing/share-offsite/?url=${url}`,path:"M4.98 3.5a2.5 2.5 0 1 1 0 5.001 2.5 2.5 0 0 1 0-5zM3 9h4v12H3zM9 9h3.8v1.6h.1c.5-.9 1.8-1.9 3.7-1.9 4 0 4.8 2.6 4.8 6v6H17v-5.3c0-1.3 0-3-1.9-3s-2.2 1.4-2.2 2.9V21H9z"},
    {label:'Ø¨Ø±ÙŠØ¯',href:`mailto:?subject=${encodeURIComponent('Ù„ØªØ± Ù‡Ø¯ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†')}&body=${text}%0A${url}`,path:"M3 6h18v12H3z M3 8.2 12 13l9-4.8"}
  ];
  for(const it of items){
    const a=document.createElement('a'); a.href=it.href; a.target="_blank"; a.rel="noopener"; a.setAttribute('aria-label',it.label);
    a.innerHTML=`<svg viewBox="0 0 24 24"><path d="${it.path}" fill="#C6A14A"/></svg>`;
    row.appendChild(a);
  }
}

/* ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚ÙŠÙ… */
function applyChanges(){
  $("brandName").textContent=company.value.trim()||'Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©';
  $("stampCompany").textContent=$("brandName").textContent;
  $("titleOut").textContent=titleIn.value.trim()||'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©';
  $("contentOut").textContent=(contentIn.value||'').replace(/[Ù -Ù©Û°-Û¹]/g,d=>DM[d])||'â€”';
  $("addressOut").textContent=addressIn.value.trim()||'â€”';
  $("crOut").textContent='CR: '+((cr.value||'').replace(/[Ù -Ù©Û°-Û¹]/g,d=>DM[d])||'â€”');
  $("phoneOut").textContent='Tel: '+(((country.value||'')+' '+(phone.value||'').replace(/[Ù -Ù©Û°-Û¹]/g,d=>DM[d])).trim()||'â€”');
  $("personName").textContent=personNameIn.value.trim()||'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠ';
  $("personRole").textContent=personRoleIn.value.trim()||'Ø§Ù„ØµÙØ© / Ø§Ù„ÙˆØ¸ÙŠÙØ©';
  buildSocial(); saveState();
}

/* ØªØ­Ø¬ÙŠÙ… Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
const viewport=$("viewport"), scaleBox=$("scaleBox");
function fit(){const avail=viewport.clientWidth-6;const PAGE=210*96/25.4;const s=Math.min(1,avail/PAGE);scaleBox.style.transform=`scale(${s})`;viewport.style.height=(297*96/25.4*s)+'px'}
addEventListener("resize",()=>requestAnimationFrame(fit),{passive:true});

/* ØªÙˆÙ‚ÙŠØ¹ */
const sig=$("sigCanvas"), ctx=sig.getContext("2d");
function resizeSig(){const DPR=Math.min(devicePixelRatio||1,1.75);const w=sig.clientWidth,h=sig.clientHeight;sig.width=w*DPR;sig.height=h*DPR;ctx.setTransform(DPR,0,0,DPR,0,0);ctx.lineWidth=2.8;ctx.lineCap='round';ctx.strokeStyle='#111';ctx.clearRect(0,0,w,h)}
function pos(e){const r=sig.getBoundingClientRect();const t=e.touches?e.touches[0]:e;return{x:t.clientX-r.left,y:t.clientY-r.top}}
let draw=false;
sig.addEventListener('mousedown',e=>{draw=true;const p=pos(e);ctx.beginPath();ctx.moveTo(p.x,p.y)});
sig.addEventListener('mousemove',e=>{if(!draw)return;const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke()});
addEventListener('mouseup',()=>draw=false);
sig.addEventListener('touchstart',e=>{e.preventDefault();draw=true;const p=pos(e);ctx.beginPath();ctx.moveTo(p.x,p.y)},{passive:false});
sig.addEventListener('touchmove',e=>{e.preventDefault();if(!draw)return;const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke()},{passive:false});
sig.addEventListener('touchend',()=>draw=false);
$("clearSig").onclick=()=>{resizeSig();$("sigInStamp").innerHTML='';saveState({signatureDataURL:''})};
$("useSig").onclick=()=>{const url=sig.toDataURL('image/png');$("sigInStamp").innerHTML='';const img=new Image();img.src=url;img.alt='Ø§Ù„ØªÙˆÙ‚ÙŠØ¹';$("sigInStamp").appendChild(img);saveState({signatureDataURL:url})};

/* PDF */
async function renderA4Canvas(){
  const src=$("page"); const clone=src.cloneNode(true);
  Object.assign(clone.style,{width:'210mm',height:'297mm',transform:'none',boxShadow:'none',position:'static'});
  const holder=document.createElement('div');Object.assign(holder.style,{position:'fixed',left:'-9999px',top:'0',background:'#fff'});holder.appendChild(clone);document.body.appendChild(holder);
  const canvas=await html2canvas(clone,{scale:2,backgroundColor:'#ffffff',useCORS:true});
  document.body.removeChild(holder); return canvas;
}
async function makePDFBlob(){const {jsPDF}=window.jspdf;const c=await renderA4Canvas();const img=c.toDataURL('image/jpeg',0.96);const pdf=new jsPDF('p','mm','a4');pdf.addImage(img,'JPEG',0,0,210,297,'','FAST');return pdf.output('blob')}
$("downloadPdf").onclick=async()=>{const blob=await makePDFBlob();const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='letterhead.pdf';a.click();URL.revokeObjectURL(url)};
$("sharePdf").onclick=async()=>{try{const blob=await makePDFBlob();const file=new File([blob],'letterhead.pdf',{type:'application/pdf'});if(navigator.canShare&&navigator.canShare({files:[file]})){await navigator.share({title:'Letterhead',text:'Ù„ØªØ± Ù‡Ø¯ PDF',files:[file]});}else{showMsg('Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©','Ø­Ù…Ù‘Ù„ Ù…Ù„Ù <strong>PDF</strong> Ø«Ù… Ø´Ø§Ø±ÙƒÙ‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.')}}catch(e){showMsg('Ø®Ø·Ø£','ØªØ¹Ø°Ù‘Ø±Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¢Ù†.')}};

/* Ø·Ø¨Ø§Ø¹Ø© â€” ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± */
$("printView").addEventListener("click",()=>{window.focus();window.print()});

/* ØªÙ‡ÙŠØ¦Ø© */
(document.fonts?.ready||Promise.resolve()).then(()=>{
  resizeSig(); loadState(); applyChanges(); buildShareBar(); fit(); setTimeout(fit,40);
});

/* Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„ØªØºÙŠÙŠØ±Ø§Øª */
['input','change'].forEach(ev=>{
  document.querySelectorAll('input,textarea,select').forEach(el=>{
    el.addEventListener(ev,()=>{if(['phone','cr','contentIn','titleIn'].includes(el.id))el.value=(el.value||'').replace(/[Ù -Ù©Û°-Û¹]/g,d=>DM[d]);applyChanges()},{passive:true});
  });
});
</script>
</body>
</html>
