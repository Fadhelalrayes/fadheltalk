<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="description" content="ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: Ø£Ø¯Ø§Ø© ØªØ«Ù‚ÙŠÙÙŠØ© Ù„Ù„ÙƒØ´Ù Ø§Ù„Ù…Ø¨ÙƒØ± Ø¹Ù† Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯ØŒ Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø· Ù„Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆÙ…Ø±Ø§ÙƒØ² Ù…ÙˆØ«ÙˆÙ‚Ø© ÙÙŠ Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©. Ù„Ø§ ØªØºÙ†ÙŠ Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ©.">
<meta name="keywords" content="Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯, ÙØ­Øµ Ø§Ù„ØªÙˆØ­Ø¯, Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØªÙˆØ­Ø¯, Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø­ÙƒÙˆÙ…ÙŠØ© Ù„Ù„ØªÙˆØ­Ø¯, ØªÙˆØ¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯, autism symptoms checker arabic">
<meta name="robots" content="index, follow"/>
<title>ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯ â€” ØªÙˆØ¹ÙŠØ© ÙˆØªØ­ÙˆÙŠÙ„Ø§Øª Ø·Ø¨ÙŠØ©</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f0f8ff; --ink:#001f3f; --muted:#708090;
    --card:#ffffff; --line:#d3d3d3;
    --primary:#4169e1; --primary-soft:#add8e6;
    --ok:#228b22; --ok-bg:#f0fff0; --ok-br:#90ee90;
    --warn:#ffd700; --warn-bg:#fffacd; --warn-br:#eee8aa;
    --danger:#ff4500; --danger-bg:#ffe4e1; --danger-br:#ffc0cb;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:"Cairo",sans-serif; background:var(--bg); color:var(--ink)}
  header{text-align:center; padding:24px 12px; background:linear-gradient(to bottom, var(--primary), var(--primary-soft)); color:#fff; border-radius:0 0 20px 20px;}
  .brand{font-family:"Amiri",serif; font-size:clamp(28px,5vw,48px); margin:0;}
  .tag{margin-top:8px; font-size:15px; color:#f0f8ff; line-height:1.6}
  .shell{max-width:1024px; margin:0 auto; padding:0 18px}
  .hero{background:var(--card); border:1px solid var(--line); border-radius:20px; padding:24px; box-shadow:0 6px 16px rgba(0,0,0,.08); margin-top:20px;}
  .row{display:grid; gap:18px}
  @media(min-width:960px){ .row{grid-template-columns:1.3fr .7fr} }

  .field{display:flex; flex-direction:column; gap:8px; margin-bottom:14px}
  .hint{font-size:13px; color:var(--muted)}
  .center{text-align:center}

  .seg{display:flex; gap:8px; justify-content:center; flex-wrap:wrap}
  .seg button{
    flex:1; padding:12px 16px; border-radius:12px; border:1px solid var(--line);
    background:#f8f9fa; cursor:pointer; max-width:220px; font-weight:700; transition:background 0.3s;
  }
  .seg button:hover{background:#e9ecef;}
  .seg button.on{background:var(--primary); color:#fff; border-color:var(--primary);}

  .select{ position:relative; display:inline-block; width:100% }
  .select select{
    width:100%; appearance:none; background:#fff; border:1px solid var(--primary); border-radius:12px;
    padding:14px 44px 14px 14px; font-size:1.05rem; cursor:pointer; color:var(--ink); text-align:right;
  }
  .select::after{
    content:""; position:absolute; top:50%; transform:translateY(-50%); right:14px; width:20px; height:20px;
    background:linear-gradient(135deg,var(--primary),var(--primary-soft));
    -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    pointer-events:none;
  }

  .btn{padding:14px 24px; border-radius:12px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--primary),var(--primary-soft)); color:#fff; font-weight:700; display:block; margin:0 auto; transition:transform 0.2s;}
  .btn:hover{transform:scale(1.05);}

  .resultbox{display:none; border-radius:16px; padding:16px; border:1px solid; font-weight:700; text-align:center; margin-bottom:16px;}
  .rb-ok{ background:var(--ok-bg); border-color:var(--ok-br); color:var(--ok); }
  .rb-warn{ background:var(--warn-bg); border-color:var(--warn-br); color:var(--warn); }
  .rb-danger{ background:var(--danger-bg); border-color:var(--danger-br); color:var(--danger); }

  .deck{display:grid; gap:14px; grid-template-columns:1fr; margin-top:18px}
  @media(min-width:860px){ .deck{grid-template-columns:repeat(2,1fr)} }
  .card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:16px; box-shadow:0 3px 8px rgba(0,0,0,.05)}
  .card h3{margin:0 0 8px; font-family:"Amiri",serif; color:var(--primary); font-size:1.3rem}
  .card p, .card ul{margin:0; font-size:15px; color:var(--ink); line-height:1.8}
  .card ul{margin-top:10px; padding-inline-start:22px}

  .iconbtn{width:36px; height:36px; border-radius:10px; display:flex; align-items:center; justify-content:center; border:1px solid var(--line); background:#fff; cursor:pointer; transition:background 0.3s;}
  .iconbtn:hover{background:#f0f8ff;}

  .pdfwrap{margin-top:14px; text-align:center; display:none}
  .pdfbtn{padding:12px 18px; border-radius:12px; border:1px solid var(--primary); background:#fff; cursor:pointer; font-weight:700; transition:background 0.3s;}
  .pdfbtn:hover{background:var(--primary-soft);}

  .msg-backdrop{
    position:fixed; inset:0; background:rgba(0,0,0,.4);
    display:none; align-items:center; justify-content:center; z-index:100000;
  }
  .msg-backdrop.show{ display:flex; }
  .msg-box{
    width:min(95vw,560px); background:#fff; border:1px solid var(--primary);
    border-radius:18px; box-shadow:0 25px 60px rgba(0,0,0,.2);
    padding:20px; text-align:center;
  }
  .msg-title{
    font-family:"Amiri",serif; font-size:22px; color:var(--primary); margin:8px 0 4px;
  }
  .msg-text{ color:var(--ink); line-height:1.9; margin:10px 0 16px }
  .msg-actions{ display:flex; justify-content:center }
  .msg-btn{
    padding:12px 20px; border-radius:12px; border:1px solid var(--primary);
    background:linear-gradient(90deg,var(--primary),var(--primary-soft)); color:#fff; font-weight:700; cursor:pointer;
  }
  .msg-box.error{ border-color:#ff0000; }
  .msg-box.error .msg-title{ color:#ff0000 }
</style>
</head>
<body>
<header>
  <div class="brand">ÙØ§Ø­Øµ Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯</div>
  <div class="tag">
    Ø£Ø¯Ø§Ø© ØªØ«Ù‚ÙŠÙÙŠØ© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ù„ÙƒØ´Ù Ø§Ù„Ù…Ø¨ÙƒØ± Ø¹Ù† Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯ ÙˆØ¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø®Ø·ÙˆØ±Ø©ØŒ Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø· Ù„Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆÙ…Ø±Ø§ÙƒØ² Ù…ÙˆØ«ÙˆÙ‚Ø©. Ù„Ø§ ØªÙØºÙ†ÙŠ Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ù…Ù‡Ù†ÙŠØ©.  
    <strong>Ø§Ù„Ù…ØµØ§Ø¯Ø±:</strong> WHOØŒ CDCØŒ Autism SpeaksØŒ NHSØŒ APAØŒ NICE.
  </div>
</header>

<main class="shell">
  <section class="hero">
    <div class="row">
      <div>
        <!-- Ø§Ù„Ø¯ÙˆÙ„Ø© -->
        <div class="field">
          <label><strong>Ø§Ø®ØªØ± Ø¯ÙˆÙ„ØªÙƒ</strong></label>
          <div class="select">
            <select id="countrySelect" aria-label="Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©">
              <option value="BHR" selected>Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
              <option value="KSA">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
              <option value="ARE">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
              <option value="QAT">Ù‚Ø·Ø±</option>
              <option value="KWT">Ø§Ù„ÙƒÙˆÙŠØª</option>
              <option value="OMN">Ø¹ÙÙ…Ø§Ù†</option>
              <option value="EGY">Ù…ØµØ±</option>
              <option value="JOR">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
              <option value="LBN">Ù„Ø¨Ù†Ø§Ù†</option>
              <option value="IRQ">Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
              <option value="LBA">Ù„ÙŠØ¨ÙŠØ§</option>
              <option value="MAR">Ø§Ù„Ù…ØºØ±Ø¨</option>
              <option value="DZA">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
              <option value="TUN">ØªÙˆÙ†Ø³</option>
              <option value="SDN">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
              <option value="SYR">Ø³ÙˆØ±ÙŠØ§</option>
              <option value="PSE">ÙÙ„Ø³Ø·ÙŠÙ†</option>
              <option value="DJI">Ø¬ÙŠØ¨ÙˆØªÙŠ</option>
              <option value="COM">Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±</option>
              <option value="MRT">Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§</option>
              <option value="SOM">Ø§Ù„ØµÙˆÙ…Ø§Ù„</option>
              <option value="YEM">Ø§Ù„ÙŠÙ…Ù†</option>
              <option value="IRN">Ø¥ÙŠØ±Ø§Ù†</option>
            </select>
          </div>
          <div class="hint">Ù„Ø¹Ø±Ø¶ Ù…Ø³ØªØ´ÙÙ‰ Ø­ÙƒÙˆÙ…ÙŠ ÙˆÙ…Ø±ÙƒØ² Ù…Ø­Ù„ÙŠ Ù…ÙˆØµÙ‰ Ø¨Ù‡ Ù„Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹.</div>
        </div>

        <!-- Ø§Ù„Ù†ÙˆØ¹ -->
        <div class="field center">
          <label><strong>Ø§Ù„Ù†ÙˆØ¹</strong></label>
          <div class="seg" id="sexSeg">
            <button type="button" class="on" data-sex="male">Ø°ÙƒØ±</button>
            <button type="button" data-sex="female">Ø£Ù†Ø«Ù‰</button>
          </div>
        </div>

        <!-- Ø§Ù„Ø¹Ù…Ø± -->
        <div class="field center">
          <label><strong>Ø§Ù„Ø¹Ù…Ø±</strong></label>
          <input id="age" type="number" inputmode="numeric" min="0" max="120" placeholder="Ù…Ø«Ø§Ù„: 5" style="width:180px; padding:12px; border:1px solid var(--line); border-radius:10px; text-align:center; margin:0 auto">
        </div>

        <!-- Ø¹ÙˆØ§Ù…Ù„ -->
        <div class="field center">
          <label><strong>Ø¹ÙˆØ§Ù…Ù„ Ù…Ø¤Ø«Ø±Ø©</strong></label>
          <div class="seg" id="familySeg">
            <button type="button" class="on" data-fh="no">Ù„Ø§ ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚ÙˆÙŠ</button>
            <button type="button" data-fh="yes">ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚ÙˆÙŠ</button>
          </div>
        </div>

        <!-- Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ -->
        <div id="symptoms" class="card">
          <h3>Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ (Ø§Ø®ØªØ± Ù†Ø¹Ù…/Ù„Ø§)</h3>
          <div class="hint">Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙŠ ÙŠØ³ØªÙ…Ø± ÙˆÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙŠØ³ØªÙ„Ø²Ù… ØªÙ‚ÙŠÙŠÙ…Ù‹Ø§ Ø·Ø¨ÙŠÙ‹Ø§.</div>

          <div class="field"><div><strong>ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ø£Ùˆ Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¹ Ø§Ù„Ø£Ù‚Ø±Ø§Ù†</strong></div>
            <div class="seg" data-q="social">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø³Ù„ÙˆÙƒÙŠØ§Øª Ù…ØªÙƒØ±Ø±Ø© Ù…Ø«Ù„ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø£Ùˆ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</strong></div>
            <div class="seg" data-q="repetitive">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø­Ø³Ø§Ø³ÙŠØ© Ù…ÙØ±Ø·Ø© ØªØ¬Ø§Ù‡ Ø§Ù„Ø£ØµÙˆØ§Øª Ø£Ùˆ Ø§Ù„Ø£Ø¶ÙˆØ§Ø¡ Ø£Ùˆ Ø§Ù„Ù…Ù„Ù…Ø³</strong></div>
            <div class="seg" data-q="sensory">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>ØªØ£Ø®Ø± ÙÙŠ Ø§Ù„ÙƒÙ„Ø§Ù… Ø£Ùˆ Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø§Ø³Ø¨</strong></div>
            <div class="seg" data-q="speech">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø¹Ø¯Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø¨ØµØ±ÙŠ Ø£Ùˆ ØªØ¬Ù†Ø¨ Ø§Ù„Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¹ÙŠÙˆÙ†</strong></div>
            <div class="seg" data-q="eyecontact">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>ØµØ¹ÙˆØ¨Ø© ÙÙŠ ÙÙ‡Ù… Ø§Ù„Ù…Ø´Ø§Ø¹Ø± Ø£Ùˆ Ø§Ù„ØªØ¹Ø¨ÙŠØ± Ø¹Ù†Ù‡Ø§</strong></div>
            <div class="seg" data-q="emotions">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>ØªÙØ¶ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ù…Ù†ÙØ±Ø¯ Ø£Ùˆ Ø¹Ø¯Ù… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª</strong></div>
            <div class="seg" data-q="play">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø±Ø¯ÙˆØ¯ ÙØ¹Ù„ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙÙŠ Ø§Ù„Ø±ÙˆØªÙŠÙ†</strong></div>
            <div class="seg" data-q="routine">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø§Ù‡ØªÙ…Ø§Ù… Ù…ÙØ±Ø· Ø¨Ù…ÙˆØ§Ø¶ÙŠØ¹ Ù…Ø­Ø¯Ø¯Ø© Ø£Ùˆ Ø£Ø¬Ø²Ø§Ø¡ Ù…Ù† Ø§Ù„Ø£Ø´ÙŠØ§Ø¡</strong></div>
            <div class="seg" data-q="interests">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>ØµØ¹ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†Ø´Ø·Ø©</strong></div>
            <div class="seg" data-q="transitions">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ù…Ø´ÙƒÙ„Ø§Øª ÙÙŠ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ø±ÙƒÙŠ Ø£Ùˆ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø©</strong></div>
            <div class="seg" data-q="motor">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
          <div class="field"><div><strong>Ø¹Ø¯Ù… Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø£ÙˆØ§Ù…Ø±</strong></div>
            <div class="seg" data-q="response">
              <button type="button" class="on" data-a="no">Ù„Ø§</button><button type="button" data-a="yes">Ù†Ø¹Ù…</button>
            </div>
          </div>
        </div>

        <button class="btn" id="calc">Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        <div class="pdfwrap" id="pdfwrap">
          <button class="pdfbtn" id="pdfBtn">ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ PDF</button>
        </div>
      </div>

      <div>
        <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
        <div id="resultBox" class="resultbox rb-ok">
          Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©: <span id="riskText">Ù…Ù†Ø®ÙØ¶Ø©</span> â€” <span id="actionText">Ø±Ø§Ù‚Ø¨ Ø§Ù„ØªØ·ÙˆØ± ÙˆØ§Ø³ØªØ´Ø± Ø·Ø¨ÙŠØ¨Ù‹Ø§ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±.</span>
        </div>

        <div class="deck" id="adviceDeck" style="display:none"></div>

        <!-- ØªÙˆØµÙŠØ§Øª Ù…Ø­Ù„ÙŠØ© ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
        <div id="localBox" class="card" style="margin-top:12px; display:none">
          <h3>ØªÙˆØµÙŠØ§Øª Ø·Ø¨ÙŠØ© ÙÙŠ Ø¨Ù„Ø¯Ùƒ</h3>
          <div class="hint">Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØŒ Ø«Ù… Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…ØªØ®ØµØµ Ø¥Ø°Ø§ ØªÙˆÙØ±. Ø²Ø± Ø§Ù„Ø§ØªØµØ§Ù„ ÙŠØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
          <div id="govHospital" style="margin-top:10px; font-size:14px; color:#374151; border-bottom:1px solid var(--line); padding-bottom:10px;"></div>
          <div id="localContact" style="margin-top:10px; font-size:14px; color:#374151;"></div>
        </div>

        <!-- Ù…Ø±Ø§ÙƒØ² Ø¹Ø§Ù„Ù…ÙŠØ© -->
        <div class="card" style="margin-top:12px">
          <h3>Ù…Ø±Ø§ÙƒØ² Ø¹Ø§Ù„Ù…ÙŠØ© Ù…ÙˆØ«ÙˆÙ‚Ø©</h3>
          <div class="hint">Ø§Ø®ØªØ± Ù…Ø±ÙƒØ²Ù‹Ø§ Ù„Ù…Ø¹Ø±ÙØ© Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
          <div class="select">
            <select id="intlSelect" aria-label="Ø§Ø®ØªØ± Ù…Ø±ÙƒØ²Ù‹Ø§ Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§">
              <option value="">â€” Ø§Ø®ØªØ± Ù…Ø±ÙƒØ²Ù‹Ø§ Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§ â€”</option>
              <option data-phone="+1-888-288-4762" value="https://www.autismspeaks.org/">Autism Speaks â€” Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+1-800-232-4636" value="https://www.cdc.gov/ncbddd/autism/index.html">CDC Autism Resources â€” Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+44-207-611-8888" value="https://www.autism.org.uk/">National Autistic Society â€” Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
              <option data-phone="+33-1-47-46-09-09" value="https://www.autisme-france.fr/">Autisme France â€” ÙØ±Ù†Ø³Ø§</option>
              <option data-phone="+49-30-921-1000" value="https://www.autismus.de/">Autismus Deutschland â€” Ø£Ù„Ù…Ø§Ù†ÙŠØ§</option>
              <option data-phone="+65-6323-3258" value="https://www.autism.org.sg/">Autism Resource Centre â€” Ø³Ù†ØºØ§ÙÙˆØ±Ø©</option>
              <option data-phone="+82-2-792-1234" value="https://www.autismkorea.org/">Korea Autism Society â€” ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©</option>
              <option data-phone="+66-2-260-8700" value="https://www.autisticthai.com/">Autistic Thai Foundation â€” ØªØ§ÙŠÙ„Ù†Ø¯</option>
              <option data-phone="+90-212-244-6060" value="https://www.tohumotizm.org.tr/">Tohum Autism Foundation â€” ØªØ±ÙƒÙŠØ§</option>
              <option data-phone="+971-4-344-9896" value="https://www.dubaiautismcenter.ae/">Dubai Autism Center â€” Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
              <option data-phone="+91-80-2520-8037" value="https://www.autismsocietyofindia.org/">Autism Society of India â€” Ø§Ù„Ù‡Ù†Ø¯</option>
            </select>
          </div>
          <div id="intlContact" style="margin-top:8px; font-size:14px; color:#374151; display:none"></div>
        </div>

        <!-- Ø¯Ù„ÙŠÙ„ Ø¹Ø§Ù„Ù…ÙŠ -->
        <div class="card" style="margin-top:12px">
          <h3>Ø¯Ù„ÙŠÙ„ Ø¹Ø§Ù„Ù…ÙŠ Ù…ÙˆØ«ÙˆÙ‚</h3>
          <div class="hint">Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ø¹ØªÙ…Ø¯Ø© Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§ â€” ØªÙÙØªØ­ Ù…Ø¨Ø§Ø´Ø±Ø©.</div>
          <div class="select">
            <select id="refSelect" aria-label="Ø§Ø®ØªØ± Ù…Ø±Ø¬Ø¹Ù‹Ø§ Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§">
              <option value="">â€” Ø§Ø®ØªØ± Ù…Ø±Ø¬Ø¹Ù‹Ø§ â€”</option>
              <option value="https://www.who.int/news-room/fact-sheets/detail/autism-spectrum-disorders">Ù…Ù†Ø¸Ù…Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© (WHO) â€” Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.cdc.gov/ncbddd/autism/index.html">Ù…Ø±ÙƒØ² Ù…ÙƒØ§ÙØ­Ø© Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ (CDC) â€” Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.autismspeaks.org/what-autism">Autism Speaks â€” Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.nhs.uk/conditions/autism/">Ø®Ø¯Ù…Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ© (NHS) â€” Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.autism-society.org/">Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ© Ù„Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.nice.org.uk/guidance/cg128">NICE â€” Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ­Ø¯</option>
            </select>
          </div>
        </div>

        <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙØ­Øµ -->
        <div class="card" style="margin-top:12px">
          <h3>Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙØ­Øµ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</h3>
          <div class="hint">Ø§Ø®ØªØ± Ø£Ø¯Ø§Ø© ÙØ­Øµ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ Ø£Ùˆ Ø§Ù„ØªÙ†Ø²ÙŠÙ„.</div>
          <div class="select">
            <select id="toolSelect" aria-label="Ø§Ø®ØªØ± Ø£Ø¯Ø§Ø© ÙØ­Øµ">
              <option value="">â€” Ø§Ø®ØªØ± Ø£Ø¯Ø§Ø© ÙØ­Øµ â€”</option>
              <option value="https://mchatscreen.com/">M-CHAT-R/F â€” ÙØ­Øµ Ø§Ù„ØªÙˆØ­Ø¯ Ù„Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„ØµØºØ§Ø±</option>
              <option value="https://www.autismspeaks.org/screen-your-child">M-CHAT-R Ø¹Ø¨Ø± Autism Speaks</option>
              <option value="https://vkc.vumc.org/vkc/triad/stat/">STAT â€” Ø£Ø¯Ø§Ø© ÙØ­Øµ ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ø£Ø·ÙØ§Ù„</option>
              <option value="https://agesandstages.com/products-pricing/asq3/">ASQ â€” Ø§Ø³ØªØ¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¹Ù…Ø§Ø± ÙˆØ§Ù„Ù…Ø±Ø§Ø­Ù„</option>
              <option value="https://brookespublishing.com/product/csbs-dp-itc/">CSBS DP Infant-Toddler Checklist</option>
              <option value="https://pedstest.com/">PEDS â€” ÙØ­Øµ Ø§Ù„ØªØ·ÙˆØ± Ù„Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†</option>
              <option value="https://autismcenter.org/social-challenges-screening-questionnaire/">SCSQ â€” Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</option>
              <option value="https://www.latrobe.edu.au/otarc/research/autism-detection-diagnosis/social-attention-communication">SACS-R Ùˆ SACS-PR â€” Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</option>
              <option value="https://psychology-tools.com/test/autism-spectrum-quotient">AQ â€” Ù…Ø¹Ø§Ù…Ù„ Ø·ÙŠÙ Ø§Ù„ØªÙˆØ­Ø¯</option>
            </select>
          </div>
        </div>

        <!-- Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø·Ø¨ÙŠØ© -->
        <div class="card" style="margin-top:12px">
          <h3>Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø·Ø¨ÙŠØ©</h3>
          <div class="hint">Ù…Ù‚Ø§Ù„Ø§Øª Ø¹Ù† Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ§Ù„ØªØ­Ø±Ù‘ÙŠ ØªØ´Ù…Ù„ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ­Ø°ÙŠØ±ÙŠØ© ÙˆØ®Ø·ÙˆØ§Øª Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.</div>
          <div class="select">
            <select id="srcSelect" aria-label="Ø§Ø®ØªØ± Ù…ØµØ¯Ø±Ù‹Ø§ Ø·Ø¨ÙŠÙ‹Ø§">
              <option value="">â€” Ø§Ø®ØªØ± Ù…ØµØ¯Ø±Ù‹Ø§ â€”</option>
              <option value="https://www.who.int/news-room/fact-sheets/detail/autism-spectrum-disorders">WHO â€” Ø­Ù‚Ø§Ø¦Ù‚ Ø±Ø¦ÙŠØ³ÙŠØ© Ø¹Ù† Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.cdc.gov/ncbddd/autism/signs.html">CDC â€” Ø¹Ù„Ø§Ù…Ø§Øª ÙˆØ£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.autismspeaks.org/signs-autism">Autism Speaks â€” Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.nhs.uk/conditions/autism/signs/">NHS â€” Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.autism.org.uk/advice-and-guidance/what-is-autism/the-autism-spectrum">NAS â€” Ø·ÙŠÙ Ø§Ù„ØªÙˆØ­Ø¯</option>
              <option value="https://www.nice.org.uk/guidance/qs51">NICE â€” Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ­Ø¯</option>
            </select>
          </div>
        </div>

        <!-- Ù…Ø´Ø§Ø±ÙƒØ© -->
        <div class="card" style="margin-top:12px; text-align:center">
          <h3>Ø´Ø§Ø±Ùƒ Ø§Ù„ØµÙØ­Ø©</h3>
          <div class="sharebar" style="display:flex; justify-content:center; gap:10px; flex-wrap:wrap">
            <a class="iconbtn" id="shareWA" title="ÙˆØ§ØªØ³Ø§Ø¨" aria-label="WhatsApp">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M12 0a12 12 0 00-10 18.3L1 23l4.9-1A12 12 0 1012 0zm6.5 17.2c-.3.8-1.7 1.6-2.4 1.6-.6 0-1.4.1-3.8-1-3.2-1.4-5.3-4.6-5.5-4.8-.1-.2-1.3-1.7-1.3-3.2 0-1.6.8-2.4 1.1-2.7.3-.3.7-.4 1-.4h.8c.2 0 .6 0 .9.7.3.8 1.1 2.7 1.2 2.9.1.2.2.5 0 .8-.2.3-.3.5-.6.8-.3.3-.6.6-.2 1.2.4.6 1.7 2.8 4 3.8 2.9 1.2 3 .8 3.5.8.5 0 1.8-.8 2.1-1.5.2-.7 1-1.6 1.3-1.8.2-.1.3-.2.5-.1l1 .5c.3.1.5.3.5.5-.1.4-.7 2-1 2.7z"/></svg>
            </a>
            <a class="iconbtn" id="shareTG" title="ØªÙŠÙ„ÙŠØºØ±Ø§Ù…" aria-label="Telegram">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M9 18.2l-.3 4.1c.4 0 .6-.2.8-.4l2-1.8 4.1 3c.7.4 1.3.2 1.5-.7L22 6.2c.2-1.1-.4-1.5-1.1-1.2L2.3 11.1c-1.1.4-1 1.3 0 1.6Ù„4.1 1.2 9.4-5.9c.4-.3.9-.1.5.2L9 18.2z"/></svg>
            </a>
            <a class="iconbtn" id="shareX" title="X" aria-label="X">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M3 2h4.7l5 6.8L18.7 2H22l-7.8 9.1L22 22h-4.8l-5.4-7.2L6 22H2.1l8.3-9.8L3 2z"/></svg>
            </a>
            <a class="iconbtn" id="shareFB" title="Facebook" aria-label="Facebook">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M22 12a10 10 0 10-11.6 9.9v-7H7.7V12h2.7V9.8c0-2.7 1.6-4.2 4-4.2 1.2 0 2.5.2 2.5.2v2.7h-1.4c-1.4 0-1.9.9-1.9 1.8V12h3.2l-.5 2.9h-2.7v7A10 10 0 0022 12z"/></svg>
            </a>
            <button class="iconbtn" id="copyLink" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·" aria-label="Copy Link">
              <svg viewBox="0 0 24 24" width="20" height="20"><path d="M16 1H8C6.3 1 5 2.3 5 4v12c0 1.7 1.3 3 3 3h8c1.7 0 3-1.3 3-3V4c0-1.7-1.3-3-3-3zm1 15c0 .6-.4 1-1 1H8c-.6 0-1-.4-1-1V4c0-.6.4-1 1-1h8c.6 0 1 .4 1 1v12zM7 20c0 .6.4 1 1 1h8v2H8c-1.7 0-3-1.3-3-3v-2h2v2z"/></svg>
            </button>
          </div>
        </div>

        <footer style="text-align:center; margin:12px 0 0; font-size:13px; color:var(--muted)">
          <a id="devLink" class="ghost-link" href="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0&wame_ctl=1" target="_blank" rel="noopener">Ø¨Ø±Ù…Ø¬Ø© ÙˆØªØ·ÙˆÙŠØ±: ÙØ§Ø¶Ù„ Ø§Ù„Ø±ÙŠØ³</a>
        </footer>
      </div>
    </div>
  </section>
</main>

<!-- Ù†Ø§ÙØ°Ø© Ø±Ø³Ø§Ø¦Ù„ -->
<div id="msgBackdrop" class="msg-backdrop" role="dialog" aria-modal="true" aria-labelledby="msgTitle">
  <div id="msgBox" class="msg-box">
    <div id="msgTitle" class="msg-title">ØªÙ†Ø¨ÙŠÙ‡</div>
    <div id="msgText" class="msg-text">â€”</div>
    <div class="msg-actions">
      <button id="msgOk" class="msg-btn">Ø­Ø³Ù†Ù‹Ø§</button>
    </div>
  </div>
</div>

<!-- PDF & Ù…Ø´Ø§Ø±ÙƒØ© -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
<script>
/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
const $mb = document.getElementById('msgBackdrop');
const $box = document.getElementById('msgBox');
const $txt = document.getElementById('msgText');
const $ttl = document.getElementById('msgTitle');
document.getElementById('msgOk').onclick = () => $mb.classList.remove('show');
function openMsg(message, type='info', title){
  $txt.innerHTML = message;
  $ttl.textContent = title || (type==='error' ? 'ØªÙ†Ø¨ÙŠÙ‡' : 'Ù…Ø¹Ù„ÙˆÙ…Ø©');
  $box.classList.toggle('error', type==='error');
  $mb.classList.add('show');
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ */
function makeToggle(segId, dataKey){
  const seg=document.getElementById(segId);
  seg.addEventListener('click', e=>{
    const b=e.target.closest('button'); if(!b) return;
    seg.querySelectorAll('button').forEach(x=>x.classList.remove('on'));
    b.classList.add('on');
    seg.dataset[dataKey]=Object.values(b.dataset)[0];
  });
}
makeToggle('sexSeg','sex'); makeToggle('familySeg','fh');

/* Ù†Ø¹Ù…/Ù„Ø§ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© */
document.getElementById('symptoms').addEventListener('click', e=>{
  const btn=e.target.closest('button'); if(!btn) return;
  const seg=btn.parentElement;
  seg.querySelectorAll('button').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
});

/* ÙØªØ­ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… */
['refSelect','srcSelect','toolSelect'].forEach(id=>{
  const el=document.getElementById(id);
  el.addEventListener('change', e=>{ const url=e.target.value; if(url){ window.open(url,'_blank','noopener'); e.target.value=''; }});
});

/* Ù…Ø±ÙƒØ² Ø¹Ø§Ù„Ù…ÙŠ */
const intlSelect=document.getElementById('intlSelect');
const intlContact=document.getElementById('intlContact');
intlSelect.addEventListener('change', ()=>{
  const opt = intlSelect.selectedOptions[0];
  if(!opt || !opt.value){ intlContact.style.display='none'; intlContact.innerHTML=''; return; }
  const phone = (opt.dataset.phone||'').replace(/\s+/g,'');
  const tel = phone ? `tel:${phone}` : '';
  const url = opt.value;
  const name = opt.textContent.split('â€”')[0].trim();
  intlContact.innerHTML = `${phone?`ğŸ“ <a href="${tel}"><strong>${opt.dataset.phone}</strong></a>`:'ğŸ“ â€”'} &nbsp;â€”&nbsp; <a href="${url}" target="_blank" rel="noopener">Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹ ${name}</a>`;
  intlContact.style.display='block';
});

/* Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆÙ…Ø±Ø§ÙƒØ² Ù…Ø­Ù„ÙŠØ© */
const GOVERNMENT_HOSPITALS = {
  BHR: {n: "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø³Ù„Ù…Ø§Ù†ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+973-80008100", url: "https://www.moh.gov.bh/HealthInstitution/SalmaniyaMedicalComplex?lang=en"},
  KSA: {n: "Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆØ±Ø§Ù… Ù„Ù„Ø£Ø·ÙØ§Ù„ - Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ Ø§Ù„Ø·Ø¨ÙŠØ©", phone: "+966-11-2899999", url: "https://www.kfmc.med.sa/"},
  ARE: {n: "ÙƒÙ„ÙŠÙÙ„Ø§Ù†Ø¯ ÙƒÙ„ÙŠÙ†Ùƒ Ø£Ø¨ÙˆØ¸Ø¨ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø¹ØµØ¨ÙŠ", phone: "+971-800-8-2223", url: "https://www.clevelandclinicabudhabi.ae/"},
  QAT: {n: "Ù…Ø±ÙƒØ² Ø§Ù„Ø·ÙÙ„ Ù„Ù„ØªÙˆØ­Ø¯ - Ø­Ù…Ø§Ø¯ Ø§Ù„Ø·Ø¨ÙŠØ©", phone: "+974-44398999", url: "https://www.hamad.qa/"},
  KWT: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ÙƒÙˆÙŠØª Ù„Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+965-24843900", url: "https://www.moh.gov.kw/"},
  OMN: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø®ÙˆØ¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+968-24504608", url: "https://www.moh.gov.om/"},
  EGY: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø¹ÙŠÙ†ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø·Ø¨ Ø§Ù„Ù†ÙØ³ÙŠ", phone: "+20-2-23654031", url: "https://www.mohp.gov.eg/"},
  JOR: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø¨Ø´ÙŠØ± - Ù‚Ø³Ù… Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©", phone: "+962-6-4745551", url: "https://www.moh.gov.jo/"},
  LBN: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø±ÙÙŠÙ‚ Ø§Ù„Ø­Ø±ÙŠØ±ÙŠ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+961-1-830000", url: "https://www.moph.gov.lb/"},
  IRQ: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+964-1-5410000", url: "https://moh.gov.iq/"},
  LBA: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø·Ø±Ø§Ø¨Ù„Ø³ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+218-21-4440666", url: "https://www.health.gov.ly/"},
  MAR: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ø¨Ù† Ø³ÙŠÙ†Ø§ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+212-537677777", url: "https://www.sante.gov.ma/"},
  DZA: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ù…ØµØ·ÙÙ‰ Ø¨Ø§Ø´Ø§ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+213-21-235555", url: "https://www.sante.gov.dz/"},
  TUN: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø±Ø§Ø²ÙŠ Ù„Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù†ÙØ³ÙŠØ©", phone: "+216-71-576666", url: "http://www.sante.tn/"},
  SDN: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø®Ø±Ø·ÙˆÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+249-183771717", url: "https://fmoh.gov.sd/"},
  SYR: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø¯Ù…Ø´Ù‚ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+963-11-2122700", url: "http://moh.gov.sy/"},
  PSE: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø¨ÙŠØª Ù„Ø­Ù… Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠ - Ù‚Ø³Ù… Ø§Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©", phone: "+970-2-2741161", url: "https://www.moh.ps/"},
  DJI: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø¨ÙŠÙ„ØªÙŠÙŠÙ‡ - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+253-21-351111", url: "https://sante.gouv.dj/"},
  COM: {n: "Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙˆØ·Ù†ÙŠ - ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©", phone: "+269-7731122", url: "https://sante.gouv.km/"},
  MRT: {n: "Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„ÙˆØ·Ù†ÙŠ - Ù†ÙˆØ§ÙƒØ´ÙˆØ·", phone: "+222-45291212", url: "https://sante.gov.mr/"},
  SOM: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ù…Ù‚Ø¯ÙŠØ´Ùˆ Ø§Ù„Ø¹Ø§Ù… - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+252-61-5555000", url: "https://moh.gov.so/"},
  YEM: {n: "Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø«ÙˆØ±Ø© Ø§Ù„Ø¹Ø§Ù… - ØµÙ†Ø¹Ø§Ø¡", phone: "+967-1-241111", url: "https://moh.gov.ye/"},
  IRN: {n: "Ù…Ø±ÙƒØ² Ø·Ù‡Ø±Ø§Ù† Ù„Ù„ØµØ­Ø© Ø§Ù„Ù†ÙØ³ÙŠØ© - Ù‚Ø³Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„", phone: "+98-21-66551000", url: "https://ctad.ir/"}
};

const COUNTRY_CENTERS = {
  BHR: {n: "Ù…Ø±ÙƒØ² Ø¹Ù„ÙŠØ§Ø¡ Ù„Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ù…Ø¨ÙƒØ±", phone: "+973-17730960", url: "https://aliacenter.com/"},
  KSA: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø³Ø± Ø§Ù„ØªÙˆØ­Ø¯", phone: "+966-11-4644444", url: "https://saf.org.sa/"},
  ARE: {n: "Ù…Ø±ÙƒØ² Ø¯Ø¨ÙŠ Ù„Ù„ØªÙˆØ­Ø¯", phone: "+971-4-3449896", url: "https://www.dubaiautismcenter.ae/"},
  QAT: {n: "Ù…Ø±ÙƒØ² Ø§Ù„Ø´ÙÙ„Ø­ Ù„Ù„Ø£Ø·ÙØ§Ù„ Ø°ÙˆÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø®Ø§ØµØ©", phone: "+974-44956666", url: "https://www.shafallah.org.qa/"},
  KWT: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ÙƒÙˆÙŠØª Ù„Ù„ØªÙˆØ­Ø¯", phone: "+965-25309300", url: "https://www.autism.gov.kw/"},
  OMN: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø¹Ù…Ø§Ù† Ù„Ù„ØªÙˆØ­Ø¯", phone: "+968-24599599", url: "https://www.omanautism.org/"},
  EGY: {n: "Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù…ØµØ±ÙŠØ© Ù„Ù„ØªÙˆØ­Ø¯", phone: "+20-100-000-6633", url: "https://www.autismegypt.org/"},
  JOR: {n: "Ù…Ø±ÙƒØ² Ø§Ù„Ø£Ø±Ø¯Ù† Ù„Ù„ØªÙˆØ­Ø¯", phone: "+962-6-5920000", url: "https://www.jordanautismcenter.org/"},
  LBN: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ù„Ø¨Ù†Ø§Ù†ÙŠØ©", phone: "+961-5-456789", url: "https://www.autismlebanon.org/"},
  IRQ: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠØ©", phone: "+964-771-2345678", url: "https://www.autismiraq.org/"},
  LBA: {n: "Ù…Ø±ÙƒØ² Ù„ÙŠØ¨ÙŠØ§ Ù„Ù„ØªÙˆØ­Ø¯", phone: "+218-91-3210000", url: "https://www.autism-libya.org/"},
  MAR: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ù…ØºØ±Ø¨ÙŠØ©", phone: "+212-537-202020", url: "https://www.autismemaroc.org/"},
  DZA: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠØ©", phone: "+213-21-565656", url: "https://www.autismealgerie.org/"},
  TUN: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ©", phone: "+216-71-840000", url: "https://www.autismetunisie.org/"},
  SDN: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©", phone: "+249-183-555555", url: "https://www.sudanautism.org/"},
  SYR: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„Ø³ÙˆØ±ÙŠØ©", phone: "+963-11-3333333", url: "https://www.autismsyria.org/"},
  PSE: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„ÙÙ„Ø³Ø·ÙŠÙ†ÙŠ", phone: "+970-2-2964040", url: "https://www.autismpalestine.org/"},
  DJI: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆØ­Ø¯ Ø¬ÙŠØ¨ÙˆØªÙŠ", phone: "+253-21-350000", url: "https://sante.gouv.dj/"},
  COM: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±", phone: "+269-7731122", url: "https://sante.gouv.km/"},
  MRT: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆØ­Ø¯ Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§", phone: "+222-45291212", url: "https://sante.gov.mr/"},
  SOM: {n: "Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„ØµÙˆÙ…Ø§Ù„ÙŠ", phone: "+252-61-5555000", url: "https://autismsomaliacenter.org/"},
  YEM: {n: "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØªÙˆØ­Ø¯ Ø§Ù„ÙŠÙ…Ù†ÙŠØ©", phone: "+967-1-241111", url: "https://moh.gov.ye/"},
  IRN: {n: "Ù…Ø±ÙƒØ² Ø·Ù‡Ø±Ø§Ù† Ù„Ù„ØªÙˆØ­Ø¯", phone: "+98-21-66551000", url: "https://ctad.ir/"}
};

/* Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© */
const QUESTIONS_IDS = ["social","repetitive","sensory","speech","eyecontact","emotions","play","routine","interests","transitions","motor","response"];
function isYes(id){ return document.querySelector(`.seg[data-q="${id}"] .on`)?.dataset.a==='yes'; }
function screening(age, sex, fh){
  const list = [];
  if (age < 3) list.push("ÙØ­Øµ M-CHAT Ù„Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„ØµØºØ§Ø±.");
  if (age >= 3 && age <= 18) list.push("ØªÙ‚ÙŠÙŠÙ… ADOS Ø£Ùˆ ADI-R Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±.");
  if (fh === 'yes') list.push("ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚ÙˆÙŠ: Ø§Ø³ØªØ´Ø± Ø§Ø®ØªØµØ§ØµÙŠ Ù†Ù…Ùˆ Ø£Ùˆ Ù†ÙØ³ÙŠ.");
  return list;
}
function computeRisk(){
  let score = 0;
  const heavy = ['social','repetitive','sensory','speech'];
  QUESTIONS_IDS.forEach(id => {
    const seg = document.querySelector(`.seg[data-q="${id}"]`);
    const a = seg.querySelector('button.on')?.dataset.a || 'no';
    if (a === 'yes') { score += 1; if (heavy.includes(id)) score += 1; }
  });
  if ((document.getElementById('familySeg').dataset.fh || 'no') === 'yes') score += 1;
  if (score > 10) score = 10;

  let levelText = 'Ù…Ù†Ø®ÙØ¶Ø©', cls = 'rb-ok', action = 'Ø±Ø§Ù‚Ø¨ Ø§Ù„ØªØ·ÙˆØ± ÙˆØ§Ø³ØªØ´Ø± Ø·Ø¨ÙŠØ¨Ù‹Ø§ Ø¥Ø°Ø§ Ø§Ø³ØªÙ…Ø±.';
  if (score >= 3) { levelText = 'Ù…ØªÙˆØ³Ø·Ø©'; cls = 'rb-warn'; action = 'Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ù‹Ø§ Ù„Ø¯Ù‰ Ø·Ø¨ÙŠØ¨ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø£Ùˆ Ø§Ø®ØªØµØ§ØµÙŠ Ù†Ù…Ùˆ Ø®Ù„Ø§Ù„ 1â€“2 Ø£Ø³Ø¨ÙˆØ¹.'; }
  if (score >= 6 || (isYes('social') && isYes('speech'))) { levelText = 'Ø¹Ø§Ù„ÙŠØ©'; cls = 'rb-danger'; action = 'ØªÙ‚ÙŠÙŠÙ… Ø¹Ø§Ø¬Ù„ Ø®Ù„Ø§Ù„ 24â€“72 Ø³Ø§Ø¹Ø© Ø£Ùˆ Ø£Ù‚Ø±Ø¨ Ø¹ÙŠØ§Ø¯Ø© Ù†Ù…Ùˆ.'; }
  return {levelText, cls, action};
}

/* Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù†ØµØ§Ø¦Ø­ */
function buildAdvice(age, sex, fh){
  const deck = document.getElementById('adviceDeck'); deck.innerHTML = '';
  const mk = (t, html) => { const e = document.createElement('div'); e.className = 'card'; e.innerHTML = `<h3>${t}</h3>${html}`; return e; };
  const list = screening(age, sex, fh);
  deck.append(
    mk('Ù†ØµØ§Ø¦Ø­ Ø³Ø±ÙŠØ¹Ø©', '<ul><li>Ø£ÙŠ Ø¹Ø±Ø¶ Ù…Ø³ØªÙ…Ø± ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…Ùˆ = ØªÙ‚ÙŠÙŠÙ… Ø·Ø¨ÙŠ.</li><li>Ø´Ø¬Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©.</li><li>Ø§Ø³ØªØ´Ø± Ø§Ù„Ù…ØªØ®ØµØµÙŠÙ† Ù…Ø¨ÙƒØ±Ù‹Ø§ Ù„Ø¯Ø¹Ù… Ø£ÙØ¶Ù„.</li></ul>'),
    mk('ÙØ­ÙˆØµ Ø§Ù„ØªØ­Ø±ÙŠ Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©', list.length ? '<ul>' + list.map(x => `<li>${x}</li>`).join('') + '</ul>' : '<div>Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØ­ÙˆØµ Ø±ÙˆØªÙŠÙ†ÙŠØ© Ø®Ø§ØµÙ‘Ø© Ø¨Ø¹Ù…Ø±Ùƒ Ø§Ù„Ø¢Ù† â€” Ø§ØªØ¨Ø¹ Ù†ØµÙŠØ­Ø© Ø·Ø¨ÙŠØ¨Ùƒ.</div>')
  );
  deck.style.display = 'grid';
}

/* Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© + PDF */
let lastResult = null;
document.getElementById('calc').addEventListener('click', () => {
  const age = parseFloat(document.getElementById('age').value);
  if (!(age >= 0 && age <= 120)) { openMsg('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø±Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§ Ø¨ÙŠÙ† 0 Ùˆ 120.', 'error'); return; }
  const sex = document.getElementById('sexSeg').dataset.sex || 'male';
  const fh = document.getElementById('familySeg').dataset.fh || 'no';

  const {levelText, cls, action} = computeRisk();

  const box = document.getElementById('resultBox');
  box.className = 'resultbox ' + cls;
  document.getElementById('riskText').textContent = levelText;
  document.getElementById('actionText').textContent = action;
  box.style.display = 'block';

  buildAdvice(age, sex, fh);

  const ccode = document.getElementById('countrySelect').value;
  const gov = GOVERNMENT_HOSPITALS[ccode];
  const loc = COUNTRY_CENTERS[ccode];
  const localBox = document.getElementById('localBox');
  const govHospital = document.getElementById('govHospital');
  const localContact = document.getElementById('localContact');
  govHospital.innerHTML = '';
  localContact.innerHTML = '';

  if (gov) {
    const telHref = gov.phone ? `tel:${gov.phone.replace(/\s+/g,'')}` : '';
    govHospital.innerHTML = `
      ğŸ›ï¸ <strong>Ù…Ø³ØªØ´ÙÙ‰ Ø­ÙƒÙˆÙ…ÙŠ: ${gov.n}</strong><br>
      ${gov.phone ? `ğŸ“ <a href="${telHref}"><strong>${gov.phone}</strong></a>` : 'ğŸ“ â€”'}
      &nbsp;â€”&nbsp;
      ${gov.url ? `<a href="${gov.url}" target="_blank" rel="noopener">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</a>` : ''}
    `;
  }

  if (loc && loc.n !== gov.n) {
    const telHref = loc.phone ? `tel:${loc.phone.replace(/\s+/g,'')}` : '';
    localContact.innerHTML = `
      ğŸ¥ <strong>Ù…Ø±ÙƒØ² Ù…ØªØ®ØµØµ: ${loc.n}</strong><br>
      ${loc.phone ? `ğŸ“ <a href="${telHref}"><strong>${loc.phone}</strong></a>` : 'ğŸ“ â€”'}
      &nbsp;â€”&nbsp;
      ${loc.url ? `<a href="${loc.url}" target="_blank" rel="noopener">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</a>` : ''}
    `;
  }

  localBox.style.display = 'block';

  const sel = document.getElementById('intlSelect');
  if (sel.value) {
    const opt = sel.selectedOptions[0];
    const phone = opt.dataset.phone || '';
    const tel = phone ? `tel:${phone.replace(/\s+/g,'')}` : '';
    const url = sel.value;
    const name = opt.textContent.split('â€”')[0].trim();
    intlContact.innerHTML = `${phone ? `ğŸ“ <a href="${tel}"><strong>${phone}</strong></a>` : 'ğŸ“ â€”'} &nbsp;â€”&nbsp; <a href="${url}" target="_blank" rel="noopener">Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹ ${name}</a>`;
    intlContact.style.display = 'block';
  }

  lastResult = {
    country: document.querySelector('#countrySelect option:checked').textContent,
    age, sex: (sex === 'male' ? 'Ø°ÙƒØ±' : 'Ø£Ù†Ø«Ù‰'),
    fh: (fh === 'yes' ? 'ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ Ù‚ÙˆÙŠ' : 'Ù„Ø§'),
    level: levelText, action,
    gov: gov ? {n: gov.n, phone: gov.phone || '', url: gov.url || ''} : null,
    local: loc ? {n: loc.n, phone: loc.phone || '', url: loc.url || ''} : null,
    intl: sel.value ? {n: sel.selectedOptions[0].textContent, phone: sel.selectedOptions[0].dataset.phone || '', url: sel.value} : null,
    answers: QUESTIONS_IDS.map(id => {
      const label = document.querySelector(`.seg[data-q="${id}"]`).previousElementSibling.textContent.trim();
      const a = document.querySelector(`.seg[data-q="${id}"] .on`)?.dataset.a || 'no';
      return {q: label, a: (a === 'yes' ? 'Ù†Ø¹Ù…' : 'Ù„Ø§')};
    })
  };
  document.getElementById('pdfwrap').style.display = 'block';
});

/* PDF */
document.getElementById('pdfBtn').addEventListener('click', async () => {
  if (!lastResult) { openMsg('Ø£Ø¬Ø¨ Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø£ÙˆÙ„Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø«Ù… ØªÙ†Ø²ÙŠÙ„Ù‡Ø§ PDF.', 'error'); return; }
  const box = document.createElement('div');
  box.setAttribute('dir', 'rtl');
  box.style.width = '780px'; box.style.background = '#fff'; box.style.border = '1px solid #e5e7eb'; box.style.borderRadius = '16px'; box.style.padding = '20px'; box.style.fontFamily = '"Cairo",sans-serif'; box.style.color = '#111827';

  function row(k, v) { return `<tr><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6"><strong>${k}</strong></td><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6">${v}</td></tr>`; }
  const rowsAns = lastResult.answers.map(x => row(x.q, x.a)).join('');

  const govRows = lastResult.gov ? `
    ${row('Ù…Ø³ØªØ´ÙÙ‰ Ø­ÙƒÙˆÙ…ÙŠ', lastResult.gov.n)}
    ${row('Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰', lastResult.gov.phone || 'â€”')}
    ${row('Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠ', lastResult.gov.url ? `<a href='${lastResult.gov.url}' target='_blank' rel='noopener'>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>` : 'â€”')}
  ` : '';

  const localRows = lastResult.local ? `
    ${row('Ù…Ø±ÙƒØ² Ù…ØªØ®ØµØµ', lastResult.local.n)}
    ${row('Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø±ÙƒØ²', lastResult.local.phone || 'â€”')}
    ${row('Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±ÙƒØ²', lastResult.local.url ? `<a href='${lastResult.local.url}' target='_blank' rel='noopener'>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>` : 'â€”')}
  ` : '';

  const intlRows = lastResult.intl ? `
    ${row('Ù…Ø±ÙƒØ² Ø¹Ø§Ù„Ù…ÙŠ Ù…Ø®ØªØ§Ø±', lastResult.intl.n)}
    ${row('Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø±ÙƒØ²', lastResult.intl.phone || 'â€”')}
    ${row('Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø±ÙƒØ²', lastResult.intl.url ? `<a href='${lastResult.intl.url}' target='_blank' rel='noopener'>Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>` : 'â€”')}
  ` : '';

  box.innerHTML = `
    <div style="text-align:center; margin-bottom:10px">
      <div style="font-family:'Amiri',serif; font-size:26px; color:${getComputedStyle(document.documentElement).getPropertyValue('--primary')}">ØªÙ‚Ø±ÙŠØ± Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙˆØ­Ø¯</div>
      <div style="font-size:12px; color:#6b7280">${new Date().toLocaleString('ar')}</div>
    </div>

    <table style="width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid #eee; margin-bottom:10px">
      <thead><tr style="background:linear-gradient(90deg,#e7f3ff,#fff)"><th style="padding:10px 12px; text-align:right">Ø§Ù„Ø¨Ù†Ø¯</th><th style="padding:10px 12px; text-align:right">Ø§Ù„Ù‚ÙŠÙ…Ø©</th></tr></thead>
      <tbody>
        ${row('Ø§Ù„Ø¯ÙˆÙ„Ø©', lastResult.country)}
        ${row('Ø§Ù„Ø¹Ù…Ø±', lastResult.age)}
        ${row('Ø§Ù„Ù†ÙˆØ¹', lastResult.sex)}
        ${row('ØªØ§Ø±ÙŠØ® Ø¹Ø§Ø¦Ù„ÙŠ', lastResult.fh)}
        ${row('Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©', lastResult.level)}
        ${row('Ø§Ù„ØªÙˆØµÙŠØ© Ø§Ù„Ø¢Ù†', lastResult.action)}
        ${govRows}
        ${localRows}
        ${intlRows}
      </tbody>
    </table>

    <div style="font-weight:700; margin-bottom:6px">Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶</div>
    <table style="width:100%; border:1px solid #eee; border-radius:12px; border-collapse:separate; border-spacing:0">
      <thead><tr style="background:#f9fafb"><th style="padding:8px 10px; text-align:right">Ø§Ù„Ø¹ÙØ±ÙØ¶</th><th style="padding:8px 10px; text-align:right">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</th></tr></thead>
      <tbody>${rowsAns}</tbody>
    </table>

    <div style="margin-top:10px; font-size:12px; color:#6b7280">Ù†ØªÙŠØ¬Ø© ØªØ«Ù‚ÙŠÙÙŠØ© Ø¹Ø§Ù…Ø© ÙˆÙ„ÙŠØ³Øª ØªØ´Ø®ÙŠØµÙ‹Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ù„Ù„Ø£Ø±Ù‚Ø§Ù….</div>
  `;

  document.body.appendChild(box);
  await new Promise(r => setTimeout(r, 120));
  const canvas = await html2canvas(box, {scale: 2, useCORS: true});
  document.body.removeChild(box);

  const imgData = canvas.toDataURL('image/png');
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({orientation: 'p', unit: 'pt', format: 'a4'});
  const pageW = pdf.internal.pageSize.getWidth();
  const pageH = pdf.internal.pageSize.getHeight();
  const margin = 28;
  const imgW = pageW - margin * 2;
  const imgH = canvas.height * (imgW / canvas.width);

  if (imgH <= pageH - margin * 2) {
    pdf.addImage(imgData, 'PNG', margin, margin, imgW, imgH);
  } else {
    let sH = pageH - margin * 2, ratio = canvas.width / imgW, slice = sH * ratio, pos = 0;
    while (pos < canvas.height) {
      const sliceCanvas = document.createElement('canvas');
      sliceCanvas.width = canvas.width;
      sliceCanvas.height = Math.min(slice, canvas.height - pos);
      sliceCanvas.getContext('2d').drawImage(canvas, 0, pos, canvas.width, sliceCanvas.height, 0, 0, sliceCanvas.width, sliceCanvas.height);
      const sliceData = sliceCanvas.toDataURL('image/png');
      if (pos > 0) pdf.addPage();
      pdf.addImage(sliceData, 'PNG', margin, margin, imgW, (sliceCanvas.height / ratio));
      pos += slice;
    }
  }
  pdf.save('Ù†ØªÙŠØ¬Ø©-Ø§Ø³ØªØ¨ÙŠØ§Ù†-Ø§Ù„ØªÙˆØ­Ø¯.pdf');
});

/* Ù…Ø´Ø§Ø±ÙƒØ© */
document.getElementById('shareWA').onclick = (e) => { e.preventDefault(); window.open(`https://wa.me/?text=${encodeURIComponent(location.href)}`, '_blank', 'noopener'); };
document.getElementById('shareTG').onclick = (e) => { e.preventDefault(); window.open(`https://t.me/share/url?url=${encodeURIComponent(location.href)}`, '_blank', 'noopener'); };
document.getElementById('shareX').onclick = (e) => { e.preventDefault(); window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(location.href)}`, '_blank', 'noopener'); };
document.getElementById('shareFB').onclick = (e) => { e.preventDefault(); window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(location.href)}`, '_blank', 'noopener'); };
document.getElementById('copyLink').onclick = async () => {
  try {
    await navigator.clipboard.writeText(location.href);
    openMsg('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!');
  } catch (err) {
    openMsg('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·.', 'error');
  }
};
document.getElementById('devLink').addEventListener('click', function() { setTimeout(() => { if (!document.hasFocus()) return; location.href = this.href; }, 120); });
</script>
</body>
</html>
