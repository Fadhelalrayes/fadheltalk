import gradio as gr
import random
import time

# --- محاكاة نموذج الذكاء الاصطناعي للدردشة ---
# هذه الدالة هي "عقل" الشات بوت.
# تستقبل رسالة المستخدم (message) وسجل المحادثة (history).
# وترجع الرد الذي سيتم عرضه.
def chat_function(message, history):
    """
    دالة تحاكي رد نموذج لغوي كبير (LLM).
    """
    # قائمة بالردود الجاهزة للمحاكاة
    responses = [
        "هذا سؤال مثير للاهتمام. بناءً على بياناتي، فإن...",
        "بالتأكيد، يمكنني المساعدة في ذلك. الخطوة الأولى هي...",
        "لم أفهم سؤالك تمامًا، هل يمكنك إعادة صياغته؟",
        "أنا نموذج ذكاء اصطناعي، وهذه بعض المعلومات حول طلبك:",
        "جاري البحث عن إجابة... لحظة من فضلك."
    ]
    
    # اختر ردًا عشوائيًا
    response = random.choice(responses)
    
    # محاكاة "التفكير" أو الكتابة التدريجية للحصول على تأثير واقعي
    full_response = ""
    for char in response:
        full_response += char
        time.sleep(0.05)  # تأخير بسيط بين كل حرف
        yield full_response # yield تقوم بتحديث الواجهة بشكل تدريجي

# --- بناء واجهة الدردشة باستخدام Gradio ---
# gr.ChatInterface هو مكون جاهز يوفر كل ما تحتاجه لواجهة الدردشة. [1, 2]
chatbot_interface = gr.ChatInterface(
    fn=chat_function,  # الدالة التي تعالج الرسائل
    title="اسأل الذكاء الاصطناعي",
    description="مرحباً بك! أنا مساعد ذكاء اصطناعي. اطرح عليّ أي سؤال وسأحاول الإجابة.",
    chatbot=gr.Chatbot(height=500), # تخصيص شكل صندوق الدردشة
    textbox=gr.Textbox(placeholder="اكتب سؤالك هنا واضغط Enter", container=False, scale=7),
    retry_btn="إعادة المحاولة",
    undo_btn="تراجع",
    clear_btn="مسح المحادثة",
)

# --- تشغيل التطبيق ---
if __name__ == "__main__":
    # .launch() تقوم بتشغيل الواجهة على خادم محلي. [3]
    chatbot_interface.launch()
