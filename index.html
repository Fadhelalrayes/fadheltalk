<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FadhelTalk â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ</title>
  <meta name="description" content="FadhelTalk: ØµÙØ­Ø© Ø¯Ø±Ø¯Ø´Ø© Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø£Ù†ÙŠÙ‚Ø© ØªØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… WebLLM Ø¨Ø¯ÙˆÙ† Ø®Ø§Ø¯Ù… Ø£Ùˆ Ù…ÙØ§ØªÙŠØ­ API." />
  <meta property="og:title" content="FadhelTalk â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ" />
  <meta property="og:description" content="Ø¯Ø±Ø¯Ø´Ø© Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø£Ù†ÙŠÙ‚Ø©ØŒ Ø®ÙÙŠÙØ©ØŒ ÙˆØªØ¹Ù…Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­." />
  <meta property="og:type" content="website" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¤–</text></svg>">
  <style>
    :root{
      --bg: #070a14;
      --bg2:#0b1120;
      --card:#0f172a;
      --edge:#1e2a46;
      --ink:#e7eefc;
      --muted:#a9b4cf;
      --brand:#87e0ff;
      --brand2:#9b8cff;
      --ok:#7cf2b0;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background: radial-gradient(1200px 600px at 80% -10%, #1b2552 0%, transparent 60%), linear-gradient(180deg, var(--bg), var(--bg2));color:var(--ink);font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Kufi Arabic",sans-serif;letter-spacing:.1px}
    a{color:var(--brand)}
    .wrap{max-width:1100px;margin:auto;padding:18px}
    /* ====== HEADER ====== */
    header{display:flex;gap:14px;align-items:center;justify-content:space-between;margin:6px 0 14px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:42px;height:42px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand2));display:grid;place-items:center;box-shadow:0 8px 28px #87e0ff30}
    .title h1{font-size:clamp(20px,3.2vw,28px);margin:0}
    .title .sub{font-size:13px;color:var(--muted)}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    .btn{background:linear-gradient(180deg,#1ea8ff,#1794ff);border:0;color:#061228;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid var(--edge);color:var(--ink)}
    .btn[disabled]{opacity:.6;cursor:not-allowed}/* ====== HERO ====== */
.hero{position:relative;overflow:hidden;border-radius:20px;background:linear-gradient(180deg,#0b1534,#0c1738);border:1px solid #1a2750;box-shadow:0 20px 50px #0006;margin-bottom:14px}
.hero .grad{position:absolute;inset:0;background:radial-gradient(500px 200px at 20% -10%,#7ae1ff22,transparent 60%),radial-gradient(400px 180px at 90% -20%,#a38bff22,transparent 60%)}
.hero .inner{position:relative;padding:18px}
.hero .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:14px}
.card{background:linear-gradient(180deg,#0b1229,#0b142e);border:1px solid var(--edge);border-radius:18px;box-shadow:0 10px 30px #0005}

/* ====== CHAT ====== */
.chat{height:min(64vh,680px);overflow:auto;padding:12px}
.row{display:flex;gap:10px;margin:10px 0;align-items:flex-start}
.avatar{flex:0 0 36px;height:36px;border-radius:50%;background:#1b254a;display:grid;place-items:center;font-weight:700;color:#cfe3ff}
.msg{padding:12px 14px;border-radius:14px;line-height:1.75;max-width:85%;background:#0b1734;border:1px solid #20305a;white-space:pre-wrap;word-break:break-word}
.user .msg{background:#15254a}
.bot .msg{background:#0b1734}
.time{font-size:12px;color:var(--muted);margin-top:4px}

/* INPUT PANE */
.pane{padding:12px;display:grid;gap:10px}
textarea{width:100%;min-height:88px;resize:y;background:#0b1128;color:var(--ink);border:1px solid #20305a;border-radius:14px;padding:12px;line-height:1.85}
.controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
select, input[type="range"]{background:#0b1128;color:var(--ink);border:1px solid #20305a;border-radius:12px;padding:10px}
.range{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:13px}

/* SIDE CARD */
.side{padding:14px}
.kv{display:grid;gap:10px}
.kv .row2{display:flex;justify-content:space-between;gap:10px;align-items:center}
.hint{font-size:12px;color:var(--muted)}
.badge{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#0f1a38;border:1px solid #20305a;font-size:12px}
.ok{color:var(--ok)}
.spin{display:inline-block;inline-size:1em;block-size:1em;border:.18em solid #69d; border-top-color:transparent;border-radius:50%;animation:sp 1s linear infinite;vertical-align:-2px}
@keyframes sp{to{transform:rotate(1turn)}}

footer{margin:16px 0;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px}

@media (max-width: 960px){
  .hero .grid{grid-template-columns:1fr}
  .chat{height:60vh}
}

  </style>
  <!-- WebLLM: ØªØ´ØºÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ -->
  <script src="https://unpkg.com/@mlc-ai/web-llm@0.2.77/dist/index.min.js"></script>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">ğŸ’¬</div>
        <div class="title">
          <h1>FadhelTalk â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ</h1>
          <div class="sub">ÙˆØ§Ø¬Ù‡Ø© Ø¯Ø±Ø¯Ø´Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© ØªØ¹Ù…Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­ â€” Ø¨Ø¯ÙˆÙ† Ø®Ø§Ø¯Ù… ÙˆØ¨Ø¯ÙˆÙ† Ù…ÙØ§ØªÙŠØ­ API</div>
        </div>
      </div>
      <div class="actions">
        <button class="btn" id="btn-download" title="ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
        <button class="btn ghost" id="btn-reset" title="Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©">Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
      </div>
    </header><section class="hero">
  <div class="grad"></div>
  <div class="inner">
    <div class="grid">
      <div class="card">
        <section class="chat" id="chat"></section>
        <section class="pane">
          <textarea id="inp" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§â€¦ Ù…Ø«Ø§Ù„: Ø§Ø´Ø±Ø­ Ù„ÙŠ Ø¨Ø§Ø®ØªØµØ§Ø± Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù…ÙØ±Ø§Ù‚ÙØ¨ ÙˆØºÙŠØ± Ø§Ù„Ù…ÙØ±Ø§Ù‚ÙØ¨."></textarea>
          <div class="controls">
            <button class="btn" id="send">Ø£Ø±Ø³Ù„</button>
            <button class="btn ghost" id="clear">Ù…Ø³Ø­</button>
            <span id="status" class="hint"></span>
          </div>
        </section>
      </div>
      <aside class="card side">
        <div class="kv">
          <div class="row2"><div>Ù†Ù…ÙˆØ°Ø¬ Ù„ØºÙˆÙŠ</div>
            <select id="model">
              <option value="Qwen2.5-0.5B-Instruct-q4f16_1-MLC">Qwen2.5 0.5B Instruct (Ø®ÙÙŠÙ)</option>
              <option value="Phi-3-mini-4k-instruct-q4f16_1-MLC">Phi-3-mini 4K Instruct</option>
            </select>
          </div>
          <div class="row2">
            <div>Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹</div>
            <div class="range">
              <input id="temp" type="range" min="0" max="1" step="0.1" value="0.7" />
              <span id="tempv">0.7</span>
            </div>
          </div>
          <div class="row2"><div>Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ØªÙˆÙƒÙ†Ø§Øª</div>
            <select id="maxTok">
              <option>256</option><option selected>384</option><option>512</option><option>768</option>
            </select>
          </div>
          <div class="row2"><div>Ø§Ù„Ø­Ø§Ù„Ø©</div>
            <div class="badge" id="badge">ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„</div>
          </div>
          <p class="hint">ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„Ù€CDNØŒ Ø«Ù… ØªØ¹Ù…Ù„ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ù…Ø­Ù„ÙŠÙ‹Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­. Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø®Ø§Ø¯Ù….</p>
          <p class="hint">Ù†ØµÙŠØ­Ø©: Ø§Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø© Ø¨Ø§Ø³Ù… <strong>index.html</strong> ÙˆØ§Ø±ÙØ¹Ù‡Ø§ Ø¥Ù„Ù‰ GitHub Pages ÙˆØ³ØªØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
          <hr style="border:0;border-top:1px solid var(--edge)">
          <div class="hint">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</div>
          <div class="actions">
            <button class="btn ghost" id="btn-copy">Ù†Ø³Ø® Ø¢Ø®Ø± Ø¥Ø¬Ø§Ø¨Ø©</button>
            <button class="btn ghost" id="btn-theme">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±</button>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>

<footer>
  <div>Â© <span id="year"></span> FadhelTalk â€” ÙˆØ§Ø¬Ù‡Ø© Ø£Ù†ÙŠÙ‚Ø© Ø¨Ù„Ù…Ø³Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©</div>
  <div>ØµÙ†Ø¹ Ø¨Ø­Ø¨ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <a href="https://github.com/mlc-ai/web-llm" rel="noreferrer" target="_blank">WebLLM</a></div>
</footer>

  </div><script>
  // ====== Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© ======
  const elChat   = document.getElementById('chat');
  const elInp    = document.getElementById('inp');
  const elSend   = document.getElementById('send');
  const elClear  = document.getElementById('clear');
  const elModel  = document.getElementById('model');
  const elTemp   = document.getElementById('temp');
  const elTempV  = document.getElementById('tempv');
  const elMaxTok = document.getElementById('maxTok');
  const elBadge  = document.getElementById('badge');
  const elStatus = document.getElementById('status');
  const elCopy   = document.getElementById('btn-copy');
  const elTheme  = document.getElementById('btn-theme');
  const elDL     = document.getElementById('btn-download');
  const elReset  = document.getElementById('btn-reset');
  document.getElementById('year').textContent = new Date().getFullYear();

  // ====== Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ======
  let engine = null;
  let loading = false;
  let messages = JSON.parse(localStorage.getItem('ft_messages')||'null') || [
    { role: 'system', content: 'Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ù…ÙÙŠØ¯ ÙŠØ¬ÙŠØ¨ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø¥ÙŠØ¬Ø§Ø² ÙˆÙˆØ¶ÙˆØ­. Ø¥Ù† Ø·ÙÙ„ÙØ¨ ØºÙŠØ± Ø°Ù„Ùƒ ÙØ§Ù„ØªØ²Ù… Ø¨Ù„ØºØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù….' }
  ];

  // ====== Ø£Ø¯ÙˆØ§Øª ÙˆØ§Ø¬Ù‡Ø© ======
  function timeStr(){
    const d=new Date();
    return d.toLocaleTimeString('ar', {hour:'2-digit',minute:'2-digit'});
  }
  function setBusy(v, text){
    loading = v; elSend.disabled = v; elModel.disabled = v; elInp.disabled = v;
    const info = v ? (text || 'ÙŠØ¹Ù…Ù„â€¦ <span class="spin"></span>') : '';
    elStatus.innerHTML = info;
    elBadge.innerHTML = v ? 'Ù†Ø´ÙØ· <span class="spin"></span>' : 'Ø¬Ø§Ù‡Ø²';
  }
  function addRow(role, html){
    const row = document.createElement('div');
    row.className = 'row ' + (role==='user'?'user':'bot');
    row.innerHTML = `
      <div class="avatar">${role==='user'?'ğŸ‘¤':'ğŸ¤–'}</div>
      <div>
        <div class="msg">${html}</div>
        <div class="time">${timeStr()}</div>
      </div>`;
    elChat.appendChild(row);
    elChat.scrollTop = elChat.scrollHeight;
    return row.querySelector('.msg');
  }
  function escapeHtml(s){
    return s.replace(/[&<>\"]/g, (c)=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[c]));
  }
  function save(){ localStorage.setItem('ft_messages', JSON.stringify(messages)); }

  // ====== Ù…Ø­Ø±Ùƒ WebLLM ======
  async function ensureEngine(){
    if(engine) return engine;
    setBusy(true,'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬â€¦');
    const modelId = elModel.value;
    try{
      engine = await webllm.CreateMLCEngine(modelId, {
        initProgressCallback: (p)=>{
          const pct = Math.round((p.progress || 0)*100);
          elBadge.textContent = `ØªØ­Ù…ÙŠÙ„: ${pct}%`;
          elStatus.textContent = `ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬: ${pct}%`;
        }
      });
      elBadge.innerHTML = 'Ø¬Ø§Ù‡Ø² âœ…';
      elStatus.textContent = 'ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„';
      return engine;
    }catch(err){
      console.error(err);
      addRow('bot','Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬. Ø¬Ø±Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø¢Ø®Ø± Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
      throw err;
    }finally{ setBusy(false); }
  }

  async function send(){
    const q = (elInp.value||'').trim();
    if(!q || loading) return;
    const qEsc = escapeHtml(q);
    addRow('user', qEsc);
    const replyEl = addRow('bot','');
    elInp.value='';

    await ensureEngine();
    setBusy(true);
    try{
      const stream = await engine.chat.completions.create({
        stream: true,
        messages: [...messages, {role:'user', content:q}],
        temperature: parseFloat(elTemp.value || '0.7'),
        max_tokens: parseInt(elMaxTok.value || '384', 10)
      });
      let acc = '';
      for await (const chunk of stream){
        const delta = chunk?.choices?.[0]?.delta?.content || '';
        acc += delta; replyEl.textContent = acc; elChat.scrollTop = elChat.scrollHeight;
      }
      messages.push({role:'user', content:q});
      messages.push({role:'assistant', content:replyEl.textContent});
      save();
    }catch(err){
      console.error(err);
      replyEl.textContent = 'ØªØ¹Ø°Ø± Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª Ø£Ùˆ Ø¬Ø±Ù‘Ø¨ Ù†Ù…ÙˆØ°Ø¬Ù‹Ø§ Ø£Ø®Ù.';
    }finally{ setBusy(false); }
  }

  // ====== Ù…ÙŠØ²Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ======
  elTemp.addEventListener('input', ()=>{ elTempV.textContent = elTemp.value; });
  elSend.addEventListener('click', send);
  elInp.addEventListener('keydown', (e)=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); send(); }});
  elClear.addEventListener('click', ()=>{ elChat.innerHTML=''; addRow('bot','Ù…Ø±Ø­Ø¨Ù‹Ø§! Ø£Ù†Ø§ <strong>FadhelTalk</strong>. Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠØ¡ âœ¨'); messages=[messages[0]]; save(); });
  elModel.addEventListener('change', ()=>{ engine=null; elBadge.textContent='Ø³ÙŠÙØ¹Ø§Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬'; });
  elCopy.addEventListener('click', async()=>{
    const last = [...document.querySelectorAll('.row.bot .msg')].pop();
    if(!last){ alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø© Ù„Ù†Ø³Ø®Ù‡Ø§ Ø¨Ø¹Ø¯.'); return; }
    await navigator.clipboard.writeText(last.textContent||'');
    elCopy.textContent='ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ“'; setTimeout(()=> elCopy.textContent='Ù†Ø³Ø® Ø¢Ø®Ø± Ø¥Ø¬Ø§Ø¨Ø©', 1600);
  });
  elDL.addEventListener('click', ()=>{
    const blob = new Blob([JSON.stringify(messages, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = Object.assign(document.createElement('a'), {href:url, download:'FadhelTalk_conversation.json'});
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });
  elReset.addEventListener('click', ()=>{
    localStorage.removeItem('ft_messages'); location.reload();
  });

  // ØªØ¨Ø¯ÙŠÙ„ Ù…Ø¸Ù‡Ø± Ø¨Ø³ÙŠØ· (Ù‚Ù„Ø¨ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù†)
  let alt=false; elTheme.addEventListener('click', ()=>{
    document.documentElement.style.setProperty('--bg', alt?'#070a14':'#05080f');
    document.documentElement.style.setProperty('--bg2',alt?'#0b1120':'#0a0f1c');
    document.documentElement.style.setProperty('--card',alt?'#0f172a':'#0e1726');
    alt=!alt; elTheme.textContent = alt? 'Ø§Ù„Ù…Ø¸Ù‡Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ' : 'ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±';
  });

  // ØªØ±Ø­ÙŠØ¨ Ø£ÙˆÙ„ÙŠ + Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ù…Ø­Ø§Ø¯Ø«Ø©
  function renderHistory(){
    elChat.innerHTML='';
    const pairs = messages.slice(1); // ØªØ¬Ø§Ù‡Ù„ system
    if(pairs.length===0){ addRow('bot','Ù…Ø±Ø­Ø¨Ù‹Ø§! Ø£Ù†Ø§ <strong>FadhelTalk</strong> â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ. Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ ÙˆØ§Ø¶ØºØ· Â«Ø£Ø±Ø³Ù„Â».'); return; }
    for (const m of pairs){ addRow(m.role==='user'?'user':'bot', escapeHtml(m.content)); }
  }
  renderHistory();
</script></body>
</html>
